<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Regression Analysis</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Overview
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="overview.html">Project Overview</a>
    </li>
    <li>
      <a href="usa_analyzing.html">United States Overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="report.html">Report</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    States of Choice
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="CA_data_analyzing.html">California</a>
    </li>
    <li>
      <a href="FL_data_analyzing.html">Florida</a>
    </li>
    <li>
      <a href="NY_data_analyzing.html">New York City</a>
    </li>
    <li>
      <a href="Ohio_data_analyzing.html">Ohio</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://paulawucu.shinyapps.io/shiny_dashboard_upload/">Interactive Maps</a>
</li>
<li>
  <a href="regression_us.html">Regression</a>
</li>
<li>
  <a href="fact.html">Facts About</a>
</li>
<li>
  <a href="https://youtu.be/nDrmCsTRqqs">
    <span class="fa fa-play-circle fa-sm"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/paulawucu/final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Regression Analysis</h1>

</div>


<div id="general-idea" class="section level1">
<h1>General Idea:</h1>
<p>In <a href="usa_analyzing.html">USA Drug Overdoes Analyzing</a>, we made a comprehensive analysis for the crude death rate resulted from drug overdose in us. We compared the change of death rate for different states in different years. Here in regression analysis, our goal is trying to build a regression model which explains the variances of drug overdose death rate among different states. The possible predictors are from social economic index and behavior statistics of residents for fifty states and Washington D.C.. We only use drug overdose death rate from 2015 - 2019 to guarantee the data availability for possible predictors.</p>
</div>
<div id="possible-predictors" class="section level1">
<h1>Possible Predictors</h1>
<p><strong>Poverty Rate:</strong> The poverty data is from <a href="https://data.census.gov/cedsci/">United States Census Bureau</a>. We imported and cleaned to get the poverty rate for fifty states and Washington D.C. from 2015 - 2019. Then, we take an average of the poverty rate for 5 years.</p>
<pre class="r"><code>## load the poverty rate data from 2015-2019

poverty_2015 = 
  read_csv(&quot;data_regression_us/povety/poverty_us_2015.csv&quot;) %&gt;% 
  select(NAME, S1701_C03_001E)
    
poverty_2015 =
    poverty_2015[-1,] %&gt;% 
    mutate(
      poverty_population_2015 = as.numeric(S1701_C03_001E),
      state = NAME
    ) %&gt;% 
    select(-c(NAME, S1701_C03_001E)) %&gt;% 
    relocate(state)



poverty_2016 = 
  read_csv(&quot;data_regression_us/povety/poverty_us_2016.csv&quot;) %&gt;% 
  select(NAME, S1701_C03_001E)
    
poverty_2016 =
    poverty_2016[-1,] %&gt;% 
    mutate(
      poverty_population_2016 = as.numeric(S1701_C03_001E),
      state = NAME
    ) %&gt;% 
    select(-c(NAME, S1701_C03_001E)) %&gt;% 
    relocate(state)



poverty_2017 = 
  read_csv(&quot;data_regression_us/povety/poverty_us_2017.csv&quot;) %&gt;% 
  select(NAME, S1701_C03_001E)
    
poverty_2017 =
    poverty_2017[-1,] %&gt;% 
    mutate(
      poverty_population_2017 = as.numeric(S1701_C03_001E),
      state = NAME
    ) %&gt;% 
    select(-c(NAME, S1701_C03_001E)) %&gt;% 
    relocate(state)



poverty_2018 = 
  read_csv(&quot;data_regression_us/povety/poverty_us_2018.csv&quot;) %&gt;% 
  select(NAME, S1701_C03_001E)
    
poverty_2018 =
    poverty_2018[-1,] %&gt;% 
    mutate(
      poverty_population_2018 = as.numeric(S1701_C03_001E),
      state = NAME
    ) %&gt;% 
    select(-c(NAME, S1701_C03_001E)) %&gt;% 
    relocate(state)



poverty_2019 = 
  read_csv(&quot;data_regression_us/povety/poverty_us_2019.csv&quot;) %&gt;% 
  select(NAME, S1701_C03_001E)
    
poverty_2019 =
    poverty_2019[-1,] %&gt;% 
    mutate(
      poverty_population_2019 = as.numeric(S1701_C03_001E),
      state = NAME
    ) %&gt;% 
    select(-c(NAME, S1701_C03_001E)) %&gt;% 
    relocate(state)
  
## combine the datasets, take average

poverty_overall =
  join_all(list(poverty_2019, poverty_2018, poverty_2017, poverty_2016, poverty_2015)) 

poverty_overall = 
  poverty_overall %&gt;% 
  mutate(sum_of_rows = rowSums((poverty_overall[,2:6]), na.rm = TRUE),
         mean_poverty_rate = 0.01 * sum_of_rows/5) %&gt;% 
  select(state, mean_poverty_rate)</code></pre>
<p><strong>Population:</strong> The population data is from <a href="https://data.census.gov/cedsci/">United States Census Bureau</a>. We imported the population data for fifty states and Washington D.C. from 2020 United States census. Here we do not count population as a predictors. This data is only used to compute other predictors from available data.</p>
<pre class="r"><code>population_us = 
  read_csv(&quot;data_regression_us/population/ACSDT5Y2019.B01003_data_with_overlays_2021-11-16T170855.csv&quot;)

population_us = 
  population_us[-1,] %&gt;% 
  mutate(
    state = NAME,
    population = as.numeric(B01003_001E)
  ) %&gt;% 
select(state, population)</code></pre>
<p><strong>Education Rate:</strong> The education data is from <a href="https://data.census.gov/cedsci/">United States Census Bureau</a>. We imported the data for fifty states and Washington D.C. from 2015 - 2019. It contains the number of population with different education level. We consider bachelor’s education as the threshold of “high education”. Therefore, we sum-up the number of people who has a bachelor or above degree. Then, we take an average of the number for 5 years. And the education rate can be calculated by dividing the high-educated population with the total population. Here education rate means that the proportion of population who receive bachelor’s or higher education.</p>
<pre class="r"><code>## load the education data from 2015-2019

education_2015 =
  read_csv(&quot;data_regression_us/education/education_us_2015.csv&quot;)

education_2015 = 
  education_2015[-1,] %&gt;% 
  select(B15003_022E, B15003_023E, B15003_024E, B15003_025E, NAME) %&gt;% 
  mutate(
    number_bachelor = as.numeric(B15003_022E),
    number_master = as.numeric(B15003_023E),
    number_profesional = as.numeric(B15003_024E),
    number_doctor = as.numeric(B15003_025E),
    state = NAME
  ) %&gt;% 
  select(state, number_bachelor, number_master, number_profesional, number_doctor) %&gt;% 
  mutate(sum_high_educ_2015 = number_bachelor + number_master + number_profesional + number_doctor) %&gt;% 
  select(state, sum_high_educ_2015)
  

education_2016 =
  read_csv(&quot;data_regression_us/education/education_us_2016.csv&quot;)

education_2016 = 
  education_2016[-1,] %&gt;% 
  select(B15003_022E, B15003_023E, B15003_024E, B15003_025E, NAME) %&gt;% 
  mutate(
    number_bachelor = as.numeric(B15003_022E),
    number_master = as.numeric(B15003_023E),
    number_profesional = as.numeric(B15003_024E),
    number_doctor = as.numeric(B15003_025E),
    state = NAME
  ) %&gt;% 
  select(state, number_bachelor, number_master, number_profesional, number_doctor) %&gt;% 
  mutate(sum_high_educ_2016 = number_bachelor + number_master + number_profesional + number_doctor) %&gt;% 
  select(state, sum_high_educ_2016)


education_2017 =
  read_csv(&quot;data_regression_us/education/education_us_2017.csv&quot;)

education_2017 = 
  education_2017[-1,] %&gt;% 
  select(B15003_022E, B15003_023E, B15003_024E, B15003_025E, NAME) %&gt;% 
  mutate(
    number_bachelor = as.numeric(B15003_022E),
    number_master = as.numeric(B15003_023E),
    number_profesional = as.numeric(B15003_024E),
    number_doctor = as.numeric(B15003_025E),
    state = NAME
  ) %&gt;% 
  select(state, number_bachelor, number_master, number_profesional, number_doctor) %&gt;% 
  mutate(sum_high_educ_2017 = number_bachelor + number_master + number_profesional + number_doctor) %&gt;% 
  select(state, sum_high_educ_2017)


education_2018 =
  read_csv(&quot;data_regression_us/education/education_us_2018.csv&quot;)

education_2018 = 
  education_2018[-1,] %&gt;% 
  select(B15003_022E, B15003_023E, B15003_024E, B15003_025E, NAME) %&gt;% 
  mutate(
    number_bachelor = as.numeric(B15003_022E),
    number_master = as.numeric(B15003_023E),
    number_profesional = as.numeric(B15003_024E),
    number_doctor = as.numeric(B15003_025E),
    state = NAME
  ) %&gt;% 
  select(state, number_bachelor, number_master, number_profesional, number_doctor) %&gt;% 
  mutate(sum_high_educ_2018 = number_bachelor + number_master + number_profesional + number_doctor) %&gt;% 
  select(state, sum_high_educ_2018)


education_2019 =
  read_csv(&quot;data_regression_us/education/education_us_2019.csv&quot;)

education_2019 = 
  education_2019[-1,] %&gt;% 
  select(B15003_022E, B15003_023E, B15003_024E, B15003_025E, NAME) %&gt;% 
  mutate(
    number_bachelor = as.numeric(B15003_022E),
    number_master = as.numeric(B15003_023E),
    number_profesional = as.numeric(B15003_024E),
    number_doctor = as.numeric(B15003_025E),
    state = NAME
  ) %&gt;% 
  select(state, number_bachelor, number_master, number_profesional, number_doctor) %&gt;% 
  mutate(sum_high_educ_2019 = number_bachelor + number_master + number_profesional + number_doctor) %&gt;% 
  select(state, sum_high_educ_2019)

## combine to produce overall education data, take average for 5 years

education_overall =
  join_all(list(education_2019, education_2018, education_2017, education_2016, education_2015))

education_overall =
  education_overall %&gt;% 
  mutate(sum_of_rows = rowSums((education_overall[,2:6]), na.rm = TRUE),
         mean_educ = sum_of_rows/5) %&gt;% 
  select(state, mean_educ)

## compute education rate

education_rate = 
  left_join(education_overall, population_us) %&gt;% 
  mutate(education_rate = mean_educ / population) %&gt;% 
  select(state, education_rate)</code></pre>
<p><strong>Unemployment Rate:</strong> The unemployment data is from <a href="https://data.census.gov/cedsci/">United States Census Bureau</a>. We imported and cleaned to get the unemployment rate for fifty states and Washington D.C. from 2015 - 2019. Then, we take an average of the unemployment rate for 5 years.</p>
<pre class="r"><code>## load the unemployment 2015-2019

unemployment_2015 =
  read_csv(&quot;data_regression_us/unemployment/unemployment_2015.csv&quot;)

unemployment_2015 = 
  unemployment_2015[-1,] %&gt;% 
  select(NAME, S2301_C04_001E) %&gt;% 
  mutate(
    unemployment_rate_2015 = as.numeric(S2301_C04_001E),
    state = NAME
  ) %&gt;% 
  select(state, unemployment_rate_2015)



unemployment_2016 =
  read_csv(&quot;data_regression_us/unemployment/unemployment_2016.csv&quot;)

unemployment_2016 = 
  unemployment_2016[-1,] %&gt;% 
  select(NAME, S2301_C04_001E) %&gt;% 
  mutate(
    unemployment_rate_2016 = as.numeric(S2301_C04_001E),
    state = NAME
  ) %&gt;% 
  select(state, unemployment_rate_2016)


unemployment_2017 =
  read_csv(&quot;data_regression_us/unemployment/unemployment_2017.csv&quot;)

unemployment_2017 = 
  unemployment_2017[-1,] %&gt;% 
  select(NAME, S2301_C04_001E) %&gt;% 
  mutate(
    unemployment_rate_2017 = as.numeric(S2301_C04_001E),
    state = NAME
  ) %&gt;% 
  select(state, unemployment_rate_2017)


unemployment_2018 =
  read_csv(&quot;data_regression_us/unemployment/unemployment_2018.csv&quot;)

unemployment_2018 = 
  unemployment_2018[-1,] %&gt;% 
  select(NAME, S2301_C04_001E) %&gt;% 
  mutate(
    unemployment_rate_2018 = as.numeric(S2301_C04_001E),
    state = NAME
  ) %&gt;% 
  select(state, unemployment_rate_2018)


unemployment_2019 =
  read_csv(&quot;data_regression_us/unemployment/unemployment_2019.csv&quot;)

unemployment_2019 = 
  unemployment_2019[-1,] %&gt;% 
  select(NAME, S2301_C04_001E) %&gt;% 
  mutate(
    unemployment_rate_2019 = as.numeric(S2301_C04_001E),
    state = NAME
  ) %&gt;% 
  select(state, unemployment_rate_2019)


## combine to overall unemployment df, take average of unemployment rate for 5 years


unemployment_overall =
  join_all(list(unemployment_2019, unemployment_2018, unemployment_2017, unemployment_2016, unemployment_2015)) 

unemployment_overall = 
  unemployment_overall %&gt;% 
  mutate(sum_of_rows = rowSums((unemployment_overall[,2:6]), na.rm = TRUE),
         mean_unemployment_rate = 0.01 * sum_of_rows/5) %&gt;% 
  select(state, mean_unemployment_rate)</code></pre>
<p><strong>Crude Divorce Rate:</strong> The divorce data is from <a href="https://data.census.gov/cedsci/">United States Census Bureau</a>. We imported the data for fifty states and Washington D.C. from 2015 - 2019. It contains the number of population who divorce with their partners. We take an average of the number for 5 years. And the crude divorce rate can be calculated by dividing the divorced population with the total population.</p>
<pre class="r"><code>## load the divorce count data from 2015-2019

divorce_2015 =
  read_csv(&quot;data_regression_us/divorce/divorce_number_2015.csv&quot;)

divorce_2015 = 
  divorce_2015[-1,] %&gt;% 
  select(NAME, B12503_004E, B12503_009E) %&gt;% 
  mutate(
    B12503_004E = as.numeric(B12503_004E),
    B12503_009E = as.numeric(B12503_009E),
    num_divorce = B12503_004E + B12503_009E,
    divorce_num_2015 = as.numeric(num_divorce),
    state = NAME
  ) %&gt;% 
  select(state, divorce_num_2015)


divorce_2016 =
  read_csv(&quot;data_regression_us/divorce/divorce_number_2016.csv&quot;)

divorce_2016 = 
  divorce_2016[-1,] %&gt;% 
  select(NAME, B12503_004E, B12503_009E) %&gt;% 
  mutate(
    B12503_004E = as.numeric(B12503_004E),
    B12503_009E = as.numeric(B12503_009E),
    num_divorce = B12503_004E + B12503_009E,
    divorce_num_2016 = as.numeric(num_divorce),
    state = NAME
  ) %&gt;% 
  select(state, divorce_num_2016)


divorce_2017 =
  read_csv(&quot;data_regression_us/divorce/divorce_number_2017.csv&quot;)

divorce_2017 = 
  divorce_2017[-1,] %&gt;% 
  select(NAME, B12503_004E, B12503_009E) %&gt;% 
  mutate(
    B12503_004E = as.numeric(B12503_004E),
    B12503_009E = as.numeric(B12503_009E),
    num_divorce = B12503_004E + B12503_009E,
    divorce_num_2017 = as.numeric(num_divorce),
    state = NAME
  ) %&gt;% 
  select(state, divorce_num_2017)


divorce_2018 =
  read_csv(&quot;data_regression_us/divorce/divorce_number_2018.csv&quot;)

divorce_2018 = 
  divorce_2018[-1,] %&gt;% 
  select(NAME, B12503_004E, B12503_009E) %&gt;% 
  mutate(
    B12503_004E = as.numeric(B12503_004E),
    B12503_009E = as.numeric(B12503_009E),
    num_divorce = B12503_004E + B12503_009E,
    divorce_num_2018 = as.numeric(num_divorce),
    state = NAME
  ) %&gt;% 
  select(state, divorce_num_2018)


divorce_2019 =
  read_csv(&quot;data_regression_us/divorce/divorce_number_2019.csv&quot;)

divorce_2019 = 
  divorce_2019[-1,] %&gt;% 
  select(NAME, B12503_004E, B12503_009E) %&gt;% 
  mutate(
    B12503_004E = as.numeric(B12503_004E),
    B12503_009E = as.numeric(B12503_009E),
    num_divorce = B12503_004E + B12503_009E,
    divorce_num_2019 = as.numeric(num_divorce),
    state = NAME
  ) %&gt;% 
  select(state, divorce_num_2019)


## combine 5 df to a overall divorce count df, take average for 5 years


divorce_overall = 
  join_all(list(divorce_2019, divorce_2018, divorce_2017, divorce_2016, divorce_2015)) 

divorce_overall = 
  divorce_overall %&gt;% 
  mutate(sum_of_rows = rowSums((divorce_overall[,2:6]), na.rm = TRUE),
         mean_divorce_num = sum_of_rows/5) %&gt;% 
  select(state, mean_divorce_num)


## compute crude divorce rate

divorce_rate = 
  left_join(divorce_overall, population_us) %&gt;% 
  mutate(divorce_rate = mean_divorce_num / population) %&gt;% 
  select(state, divorce_rate)</code></pre>
<p><strong>Smoke Rate:</strong> The smoke rate data is from <a href="https://www.americashealthrankings.org/explore/annual/measure/Smoking/state/ALL?edition-year=2015">America’s Health Rankings</a>. The smoke rate is defined as “the percentage of adults who reported smoking at least 100 cigarettes in their lifetime and currently smoke daily or some days”. We imported and clean to get the smoke rate for fifty states and Washington D.C. from 2015 - 2019. Then, we take an average of the smoke rate for 5 years.</p>
<pre class="r"><code>smoke_rate = 
  read_excel(&quot;data_regression_us/smoke/smoke_rate.xlsx&quot;)

smoke_rate = 
  smoke_rate %&gt;% 
  mutate(sum_of_rows = rowSums((smoke_rate[,2:6]), na.rm = TRUE),
         mean_smoke_rate = sum_of_rows/5) %&gt;% 
  select(state, mean_smoke_rate)</code></pre>
<p><strong>Binge Drinking:</strong> Binge drinking data is collected from <a href="https://www.statista.com/statistics/378966/us-binge-drinking-rate-adults-by-state/">Statista</a>. Binge drinking prevalence for the 51 jurisdictions (50 states and Washington D.C.). The prevalence of binge drinking is defined as number of binge drinker over the whole population within each jurisdiction.</p>
<pre class="r"><code>state_level = c(state.name[1:8], &quot;District of Columbia&quot;, state.name[9:50])

drinking_19 = 
  read_excel(&quot;./data/statistic_id378966_us-binge-drinking-among-adults-by-state-2019.xlsx&quot;, range = &quot;Data!B3:C57&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  slice(-c(1,2)) %&gt;% 
  mutate(binge_drink_rate = 0.01 * as.numeric(x2)) %&gt;% 
  select(state = u_s_binge_drinking_among_adults_by_state_2019, binge_drink_rate)</code></pre>
<p><strong>Crude Death Rate:</strong> Mentioned in the USA overview section as well. In a few words, it is the number of deaths due to drug overdose per 100,000 people.</p>
<pre class="r"><code>crudedeath_rate = 
  read.csv(&quot;./data/agegroup_race_state_year_99-19.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  select(state, year = year_code, age = ten_year_age_groups_code, race, deaths,population) %&gt;% 
  drop_na() %&gt;%
  filter(year %in% c(&quot;2015&quot;, &quot;2016&quot;, &quot;2017&quot;, &quot;2018&quot;, &quot;2019&quot;)) %&gt;%
  group_by(state) %&gt;%
  dplyr::summarize(total_deaths = sum(deaths),
           total_population = sum(population)) %&gt;% 
  mutate(crudedeath_rate = 0.01 * (total_deaths/total_population) * 100000) %&gt;% 
  select(state, crudedeath_rate)</code></pre>
</div>
<div id="regression-analyses" class="section level1">
<h1>Regression Analyses</h1>
<div id="regression-overall-data" class="section level2">
<h2>Regression Overall Data</h2>
<p>The regression overall data is produced by combining the dataset generated above. For each state, this data contains the response – the crude death rate for drug overdose and all possible predictors – binge drinking rate, divorce rate, unemployment rate, education rate, poverty rate, and smoke rate. The following tables describe this data:</p>
<pre class="r"><code>overall_regression_view = 
  join_all(list(crudedeath_rate, drinking_19, divorce_rate, unemployment_overall, education_rate, poverty_overall, smoke_rate)) 

overall_regression = 
  overall_regression_view %&gt;% 
  select(-state)

overall_regression_view %&gt;% head(10) %&gt;% knitr::kable(caption = &quot;The First 10 Rows of Regression Overall Data&quot;)</code></pre>
<table>
<caption>The First 10 Rows of Regression Overall Data</caption>
<colgroup>
<col width="15%" />
<col width="11%" />
<col width="12%" />
<col width="9%" />
<col width="16%" />
<col width="10%" />
<col width="12%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">state</th>
<th align="right">crudedeath_rate</th>
<th align="right">binge_drink_rate</th>
<th align="right">divorce_rate</th>
<th align="right">mean_unemployment_rate</th>
<th align="right">education_rate</th>
<th align="right">mean_poverty_rate</th>
<th align="right">mean_smoke_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alabama</td>
<td align="right">0.2270304</td>
<td align="right">0.136</td>
<td align="right">0.5606409</td>
<td align="right">0.0598</td>
<td align="right">0.1718737</td>
<td align="right">0.1696</td>
<td align="right">0.2082</td>
</tr>
<tr class="even">
<td align="left">Alaska</td>
<td align="right">0.2663021</td>
<td align="right">0.182</td>
<td align="right">0.5173449</td>
<td align="right">0.0722</td>
<td align="right">0.1932690</td>
<td align="right">0.1046</td>
<td align="right">0.1962</td>
</tr>
<tr class="odd">
<td align="left">Arizona</td>
<td align="right">0.2960310</td>
<td align="right">0.165</td>
<td align="right">0.5365614</td>
<td align="right">0.0594</td>
<td align="right">0.1959374</td>
<td align="right">0.1524</td>
<td align="right">0.1496</td>
</tr>
<tr class="even">
<td align="left">Arkansas</td>
<td align="right">0.2089063</td>
<td align="right">0.149</td>
<td align="right">0.5776714</td>
<td align="right">0.0516</td>
<td align="right">0.1530968</td>
<td align="right">0.1722</td>
<td align="right">0.2364</td>
</tr>
<tr class="odd">
<td align="left">California</td>
<td align="right">0.1640786</td>
<td align="right">0.183</td>
<td align="right">0.5099043</td>
<td align="right">0.0606</td>
<td align="right">0.2273319</td>
<td align="right">0.1350</td>
<td align="right">0.1160</td>
</tr>
<tr class="even">
<td align="left">Colorado</td>
<td align="right">0.2309491</td>
<td align="right">0.196</td>
<td align="right">0.5524384</td>
<td align="right">0.0434</td>
<td align="right">0.2791094</td>
<td align="right">0.1034</td>
<td align="right">0.1520</td>
</tr>
<tr class="odd">
<td align="left">Connecticut</td>
<td align="right">0.4042932</td>
<td align="right">0.177</td>
<td align="right">0.5388083</td>
<td align="right">0.0604</td>
<td align="right">0.2712121</td>
<td align="right">0.1006</td>
<td align="right">0.1342</td>
</tr>
<tr class="even">
<td align="left">Delaware</td>
<td align="right">0.6017141</td>
<td align="right">0.189</td>
<td align="right">0.4362088</td>
<td align="right">0.0542</td>
<td align="right">0.2215250</td>
<td align="right">0.1230</td>
<td align="right">0.1770</td>
</tr>
<tr class="odd">
<td align="left">District of Columbia</td>
<td align="right">0.8842317</td>
<td align="right">0.272</td>
<td align="right">0.3632256</td>
<td align="right">0.0692</td>
<td align="right">0.4124074</td>
<td align="right">0.1644</td>
<td align="right">0.1508</td>
</tr>
<tr class="even">
<td align="left">Florida</td>
<td align="right">0.2746527</td>
<td align="right">0.180</td>
<td align="right">0.5690009</td>
<td align="right">0.0564</td>
<td align="right">0.2120040</td>
<td align="right">0.1414</td>
<td align="right">0.1590</td>
</tr>
</tbody>
</table>
<pre class="r"><code>summary(overall_regression_view) %&gt;% knitr::kable(caption = &quot;Summary of The Response and The Predictors&quot;)</code></pre>
<table>
<caption>Summary of The Response and The Predictors</caption>
<colgroup>
<col width="2%" />
<col width="12%" />
<col width="11%" />
<col width="12%" />
<col width="10%" />
<col width="16%" />
<col width="10%" />
<col width="12%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">state</th>
<th align="left">crudedeath_rate</th>
<th align="left">binge_drink_rate</th>
<th align="left">divorce_rate</th>
<th align="left">mean_unemployment_rate</th>
<th align="left">education_rate</th>
<th align="left">mean_poverty_rate</th>
<th align="left">mean_smoke_rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">Length:51</td>
<td align="left">Min. :0.1182</td>
<td align="left">Min. :0.1200</td>
<td align="left">Min. :0.3632</td>
<td align="left">Min. :0.02740</td>
<td align="left">Min. :0.1449</td>
<td align="left">Min. :0.0762</td>
<td align="left">Min. :0.0910</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Class :character</td>
<td align="left">1st Qu.:0.2057</td>
<td align="left">1st Qu.:0.1653</td>
<td align="left">1st Qu.:0.5256</td>
<td align="left">1st Qu.:0.04270</td>
<td align="left">1st Qu.:0.1873</td>
<td align="left">1st Qu.:0.1092</td>
<td align="left">1st Qu.:0.1511</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Mode :character</td>
<td align="left">Median :0.2710</td>
<td align="left">Median :0.1865</td>
<td align="left">Median :0.5497</td>
<td align="left">Median :0.05320</td>
<td align="left">Median :0.2061</td>
<td align="left">Median :0.1306</td>
<td align="left">Median :0.1718</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">NA</td>
<td align="left">Mean :0.3015</td>
<td align="left">Mean :0.1858</td>
<td align="left">Mean :0.5441</td>
<td align="left">Mean :0.05128</td>
<td align="left">Mean :0.2153</td>
<td align="left">Mean :0.1321</td>
<td align="left">Mean :0.1752</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">NA</td>
<td align="left">3rd Qu.:0.3561</td>
<td align="left">3rd Qu.:0.2010</td>
<td align="left">3rd Qu.:0.5649</td>
<td align="left">3rd Qu.:0.05900</td>
<td align="left">3rd Qu.:0.2357</td>
<td align="left">3rd Qu.:0.1502</td>
<td align="left">3rd Qu.:0.1961</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">NA</td>
<td align="left">Max. :0.8842</td>
<td align="left">Max. :0.2720</td>
<td align="left">Max. :0.6018</td>
<td align="left">Max. :0.07460</td>
<td align="left">Max. :0.4124</td>
<td align="left">Max. :0.2038</td>
<td align="left">Max. :0.2568</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA’s :1</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="correlation-matrix" class="section level2">
<h2>Correlation Matrix</h2>
<pre class="r"><code>corr_matrix =
  overall_regression %&gt;% 
  chart.Correlation(histogram = TRUE, method = &quot;pearson&quot;)</code></pre>
<p><img src="regression_us_files/figure-html/correlation_table-1.png" width="90%" /></p>
<p><em>Comments:</em></p>
<p>For those variables that are strongly correlated (***) with each other, we add their interaction into the regression model for further analysis.</p>
<p>Two-ways interaction we consider:</p>
<ol style="list-style-type: decimal">
<li><p>binge_drink_rate * education_rate</p></li>
<li><p>divorce_rate * education_rate</p></li>
<li><p>mean_unemployment_rate * mean_poverty_rate</p></li>
<li><p>education_rate * mean_poverty_rate</p></li>
<li><p>education_rate * mean_smoke_rate</p></li>
<li><p>mean_poverty_rate * mean_smoke_rate</p></li>
</ol>
</div>
<div id="regression-modeling" class="section level2">
<h2>Regression Modeling</h2>
<p><strong>Method:</strong></p>
<p>The initial full model for crude death rate consists of all possible predictors and reasonable interaction.</p>
<p><em>Model_full:</em> crudedeath_rate ~ binge_drink_rate + divorce_rate + mean_unemployment_rate + education_rate + mean_poverty_rate + mean_smoke_rate + binge_drink_rate * education_rate + mean_unemployment_rate * mean_poverty_rate + education_rate * mean_poverty_rate + education_rate * mean_smoke_rate + mean_poverty_rate * mean_smoke_rate + divorce_rate * education_rate</p>
<p>Here we are going to use two modeling method and try to generate a better regression model to explain crude death rate.</p>
<div id="stepwise-modeling" class="section level3">
<h3>Stepwise Modeling</h3>
<pre class="r"><code>stepwise = 
  step(lm(crudedeath_rate ~ binge_drink_rate + divorce_rate + mean_unemployment_rate + education_rate + mean_poverty_rate + mean_smoke_rate + binge_drink_rate * education_rate + mean_unemployment_rate * mean_poverty_rate + education_rate * mean_poverty_rate + education_rate * mean_smoke_rate + mean_poverty_rate * mean_smoke_rate + divorce_rate * education_rate, data = overall_regression),direction = &quot;both&quot;, trace = 0)</code></pre>
<p>Based on the stepwise results, the best model is model_1.</p>
<p><strong>Model_1:</strong> crudedeath_rate ~ binge_drink_rate + divorce_rate + mean_unemployment_rate + education_rate + mean_poverty_rate + mean_smoke_rate + mean_poverty_rate:mean_smoke_rate + divorce_rate:education_rate</p>
<p>This model can be described in the following parameter:</p>
<pre class="r"><code>summary(stepwise) %&gt;% broom::tidy() %&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.1823514</td>
<td align="right">0.7988419</td>
<td align="right">-0.2282697</td>
<td align="right">0.8205712</td>
</tr>
<tr class="even">
<td align="left">binge_drink_rate</td>
<td align="right">-0.9643137</td>
<td align="right">0.6718818</td>
<td align="right">-1.4352432</td>
<td align="right">0.1588030</td>
</tr>
<tr class="odd">
<td align="left">divorce_rate</td>
<td align="right">1.1058355</td>
<td align="right">1.4478464</td>
<td align="right">0.7637795</td>
<td align="right">0.4493718</td>
</tr>
<tr class="even">
<td align="left">mean_unemployment_rate</td>
<td align="right">3.1693281</td>
<td align="right">2.1249877</td>
<td align="right">1.4914571</td>
<td align="right">0.1434962</td>
</tr>
<tr class="odd">
<td align="left">education_rate</td>
<td align="right">6.4472365</td>
<td align="right">2.3587499</td>
<td align="right">2.7333277</td>
<td align="right">0.0092123</td>
</tr>
<tr class="even">
<td align="left">mean_poverty_rate</td>
<td align="right">-5.7853504</td>
<td align="right">3.0285863</td>
<td align="right">-1.9102478</td>
<td align="right">0.0631129</td>
</tr>
<tr class="odd">
<td align="left">mean_smoke_rate</td>
<td align="right">-1.0370218</td>
<td align="right">2.3260266</td>
<td align="right">-0.4458340</td>
<td align="right">0.6580627</td>
</tr>
<tr class="even">
<td align="left">mean_poverty_rate:mean_smoke_rate</td>
<td align="right">23.4829679</td>
<td align="right">15.8225164</td>
<td align="right">1.4841488</td>
<td align="right">0.1454173</td>
</tr>
<tr class="odd">
<td align="left">divorce_rate:education_rate</td>
<td align="right">-9.4598001</td>
<td align="right">4.9459427</td>
<td align="right">-1.9126384</td>
<td align="right">0.0627972</td>
</tr>
</tbody>
</table>
<pre class="r"><code>summary(stepwise) %&gt;% broom::glance() %&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">df</th>
<th align="right">df.residual</th>
<th align="right">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6163078</td>
<td align="right">0.541441</td>
<td align="right">0.0981217</td>
<td align="right">8.23206</td>
<td align="right">1.4e-06</td>
<td align="right">8</td>
<td align="right">41</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
</div>
<div id="regsubset-compare-all-possible-models" class="section level3">
<h3>Regsubset() Compare All Possible Models</h3>
<pre class="r"><code>reg_subsets = 
  regsubsets(crudedeath_rate ~ binge_drink_rate + divorce_rate + mean_unemployment_rate + education_rate + mean_poverty_rate + mean_smoke_rate + binge_drink_rate * education_rate + mean_unemployment_rate * mean_poverty_rate + education_rate * mean_poverty_rate + education_rate * mean_smoke_rate + mean_poverty_rate * mean_smoke_rate + divorce_rate * education_rate, data = overall_regression, nvmax = 12)

summary(reg_subsets)</code></pre>
<p><strong>Method: </strong>This table describes the different statistics value for different number of predictors the model contains. For each number, regsubset() produces the best model and outputs the statistics in the following.</p>
<pre class="r"><code>cri_measure = 
  cbind(
    cp = summary(reg_subsets)$cp,
    r2 = summary(reg_subsets)$rsq,
    adj_r2 = summary(reg_subsets)$adjr2,
    BIC = summary(reg_subsets)$bic
  )

cri_measure</code></pre>
<pre><code>##              cp        r2    adj_r2         BIC
##  [1,] 24.568548 0.3055733 0.2911061 -10.4093868
##  [2,] 14.151243 0.4277652 0.4034148 -16.1742284
##  [3,]  6.317893 0.5245299 0.4935210 -21.5244707
##  [4,]  3.981957 0.5671975 0.5287261 -22.3135710
##  [5,]  3.236676 0.5942123 0.5481001 -21.6241191
##  [6,]  3.301372 0.6132566 0.5592924 -20.1155275
##  [7,]  4.689757 0.6192751 0.5558210 -16.9877323
##  [8,]  6.326699 0.6228478 0.5492571 -13.5471160
##  [9,]  7.034735 0.6355613 0.5535626 -11.3496172
## [10,]  9.007389 0.6358304 0.5424536  -7.4745279
## [11,] 11.001814 0.6358853 0.5304836  -3.5700381
## [12,] 13.000000 0.6359031 0.5178176   0.3395343</code></pre>
<p>Based on <strong>cp</strong>, the “best” model contains five predictors.</p>
<p><strong>Model_2:</strong> crudedeath_rate ~ binge_drink_rate + education_rate + mean_poverty_rate + mean_poverty_rate:mean_smoke_rate + divorce_rate:education_rate</p>
<p>This model can be described in the following parameter:</p>
<pre class="r"><code>model_2 = lm(data = overall_regression, formula = crudedeath_rate ~ binge_drink_rate + education_rate + mean_poverty_rate + mean_poverty_rate:mean_smoke_rate + divorce_rate:education_rate)


summary(model_2) %&gt;% broom::tidy() %&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.3219639</td>
<td align="right">0.2096655</td>
<td align="right">1.535607</td>
<td align="right">0.1317951</td>
</tr>
<tr class="even">
<td align="left">binge_drink_rate</td>
<td align="right">-1.4348310</td>
<td align="right">0.5377575</td>
<td align="right">-2.668175</td>
<td align="right">0.0106366</td>
</tr>
<tr class="odd">
<td align="left">education_rate</td>
<td align="right">5.2963056</td>
<td align="right">0.7760553</td>
<td align="right">6.824650</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">mean_poverty_rate</td>
<td align="right">-4.1019627</td>
<td align="right">1.2793286</td>
<td align="right">-3.206340</td>
<td align="right">0.0025056</td>
</tr>
<tr class="odd">
<td align="left">mean_poverty_rate:mean_smoke_rate</td>
<td align="right">18.0807105</td>
<td align="right">4.0391521</td>
<td align="right">4.476363</td>
<td align="right">0.0000532</td>
</tr>
<tr class="even">
<td align="left">education_rate:divorce_rate</td>
<td align="right">-6.7196736</td>
<td align="right">1.8057116</td>
<td align="right">-3.721344</td>
<td align="right">0.0005592</td>
</tr>
</tbody>
</table>
<pre class="r"><code>summary(model_2) %&gt;% broom::glance() %&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">df</th>
<th align="right">df.residual</th>
<th align="right">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5942123</td>
<td align="right">0.5481001</td>
<td align="right">0.0974067</td>
<td align="right">12.88622</td>
<td align="right">1e-07</td>
<td align="right">5</td>
<td align="right">44</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
<p>Based on <strong>adjusted r square</strong>, we get model_3 as the “best” model.</p>
<p><strong>Model_3:</strong> crudedeath_rate ~ binge_drink_rate + education_rate + mean_poverty_rate + mean_poverty_rate:mean_smoke_rate + divorce_rate:education_rate + mean_unemployment_rate:mean_poverty_rate</p>
<p>This model can be described in the following parameter:</p>
<pre class="r"><code>model_3 = lm(data = overall_regression, formula = crudedeath_rate ~ binge_drink_rate + education_rate + mean_poverty_rate + mean_poverty_rate:mean_smoke_rate + divorce_rate:education_rate + mean_unemployment_rate:mean_poverty_rate)


summary(model_3) %&gt;% broom::tidy() %&gt;% knitr::kable()</code></pre>
<table>
<colgroup>
<col width="49%" />
<col width="13%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.3801708</td>
<td align="right">0.2108814</td>
<td align="right">1.802771</td>
<td align="right">0.0784354</td>
</tr>
<tr class="even">
<td align="left">binge_drink_rate</td>
<td align="right">-1.0853390</td>
<td align="right">0.5828431</td>
<td align="right">-1.862146</td>
<td align="right">0.0694250</td>
</tr>
<tr class="odd">
<td align="left">education_rate</td>
<td align="right">4.7397334</td>
<td align="right">0.8565289</td>
<td align="right">5.533653</td>
<td align="right">0.0000017</td>
</tr>
<tr class="even">
<td align="left">mean_poverty_rate</td>
<td align="right">-5.9904343</td>
<td align="right">1.8111909</td>
<td align="right">-3.307456</td>
<td align="right">0.0019082</td>
</tr>
<tr class="odd">
<td align="left">mean_poverty_rate:mean_smoke_rate</td>
<td align="right">17.9418971</td>
<td align="right">3.9899597</td>
<td align="right">4.496761</td>
<td align="right">0.0000516</td>
</tr>
<tr class="even">
<td align="left">education_rate:divorce_rate</td>
<td align="right">-5.9249642</td>
<td align="right">1.8649682</td>
<td align="right">-3.176979</td>
<td align="right">0.0027542</td>
</tr>
<tr class="odd">
<td align="left">mean_poverty_rate:mean_unemployment_rate</td>
<td align="right">22.6088897</td>
<td align="right">15.5372534</td>
<td align="right">1.455141</td>
<td align="right">0.1528923</td>
</tr>
</tbody>
</table>
<pre class="r"><code>summary(model_3) %&gt;% broom::glance() %&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">df</th>
<th align="right">df.residual</th>
<th align="right">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.6132566</td>
<td align="right">0.5592924</td>
<td align="right">0.0961929</td>
<td align="right">11.36414</td>
<td align="right">1e-07</td>
<td align="right">6</td>
<td align="right">43</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
<p>Based on <strong>BIC</strong>, we get model_4 as the “best” model.</p>
<p><strong>Model_4:</strong> crudedeath_rate ~ binge_drink_rate + education_rate + mean_smoke_rate + divorce_rate:education_rate</p>
<p>This model can be described in the following parameter:</p>
<pre class="r"><code>model_4 = lm(data = overall_regression, formula = crudedeath_rate ~ binge_drink_rate + education_rate + mean_smoke_rate + divorce_rate:education_rate)


summary(model_4) %&gt;% broom::tidy() %&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.214375</td>
<td align="right">0.1768821</td>
<td align="right">-1.211965</td>
<td align="right">0.2318510</td>
</tr>
<tr class="even">
<td align="left">binge_drink_rate</td>
<td align="right">-1.565518</td>
<td align="right">0.5413276</td>
<td align="right">-2.891997</td>
<td align="right">0.0058775</td>
</tr>
<tr class="odd">
<td align="left">education_rate</td>
<td align="right">4.874933</td>
<td align="right">0.6976179</td>
<td align="right">6.987970</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">mean_smoke_rate</td>
<td align="right">2.212329</td>
<td align="right">0.5296644</td>
<td align="right">4.176850</td>
<td align="right">0.0001339</td>
</tr>
<tr class="odd">
<td align="left">education_rate:divorce_rate</td>
<td align="right">-5.427036</td>
<td align="right">1.4483395</td>
<td align="right">-3.747074</td>
<td align="right">0.0005074</td>
</tr>
</tbody>
</table>
<pre class="r"><code>summary(model_4) %&gt;% broom::glance() %&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">df</th>
<th align="right">df.residual</th>
<th align="right">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5671975</td>
<td align="right">0.5287261</td>
<td align="right">0.0994728</td>
<td align="right">14.74338</td>
<td align="right">1e-07</td>
<td align="right">4</td>
<td align="right">45</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="regression-modeling-without-interaction" class="section level2">
<h2>Regression Modeling without Interaction</h2>
<p><strong>Method:</strong></p>
<p>The initial full model for crude death rate consists of all possible predictors.</p>
<p><em>Model_full:</em> crudedeath_rate ~ binge_drink_rate + divorce_rate + mean_unemployment_rate + education_rate + mean_poverty_rate + mean_smoke_rate</p>
<p>Here we are going to use two modeling method and try to generate a better regression model to explain crude death rate.</p>
<div id="stepwise-modeling-1" class="section level3">
<h3>Stepwise Modeling</h3>
<pre class="r"><code>stepwise_no_inter = 
  step(lm(crudedeath_rate ~ binge_drink_rate + divorce_rate + mean_unemployment_rate + education_rate + mean_poverty_rate + mean_smoke_rate, data = overall_regression),direction = &quot;both&quot;, trace = 0)</code></pre>
<p>Based on the stepwise results, the best model is model_1.</p>
<p><strong>Model_5:</strong> crudedeath_rate ~ binge_drink_rate + divorce_rate + education_rate + mean_smoke_rate</p>
<p><strong>Comment:</strong></p>
<p>Since the model from regsubset() without considering the interaction is the same as model_5, we will not discuss the details of that method here.</p>
<p>This model can be described in the following parameter:</p>
<pre class="r"><code>summary(stepwise_no_inter) %&gt;% broom::tidy() %&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.4646221</td>
<td align="right">0.3226392</td>
<td align="right">1.440067</td>
<td align="right">0.1567697</td>
</tr>
<tr class="even">
<td align="left">binge_drink_rate</td>
<td align="right">-1.5395071</td>
<td align="right">0.5520224</td>
<td align="right">-2.788849</td>
<td align="right">0.0077258</td>
</tr>
<tr class="odd">
<td align="left">divorce_rate</td>
<td align="right">-1.5061409</td>
<td align="right">0.4402422</td>
<td align="right">-3.421165</td>
<td align="right">0.0013370</td>
</tr>
<tr class="even">
<td align="left">education_rate</td>
<td align="right">2.2751208</td>
<td align="right">0.4591017</td>
<td align="right">4.955592</td>
<td align="right">0.0000107</td>
</tr>
<tr class="odd">
<td align="left">mean_smoke_rate</td>
<td align="right">2.5809509</td>
<td align="right">0.5356159</td>
<td align="right">4.818660</td>
<td align="right">0.0000168</td>
</tr>
</tbody>
</table>
<pre class="r"><code>summary(stepwise_no_inter) %&gt;% broom::glance() %&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">df</th>
<th align="right">df.residual</th>
<th align="right">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5493662</td>
<td align="right">0.5093098</td>
<td align="right">0.1015012</td>
<td align="right">13.71484</td>
<td align="right">2e-07</td>
<td align="right">4</td>
<td align="right">45</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cross-validation" class="section level2">
<h2>Cross Validation</h2>
<p>We now have five candidates as considered possible “best” model for drug overdose crude death rate:</p>
<p><em>Model_1:</em> crudedeath_rate ~ binge_drink_rate + divorce_rate + mean_unemployment_rate + education_rate + mean_poverty_rate + mean_smoke_rate + binge_drink_rate:education_rate.</p>
<p><em>Model_2:</em> crudedeath_rate ~ mean_poverty_rate + mean_unemployment_rate:mean_poverty_rate + education_rate:mean_poverty_rate + mean_poverty_rate:mean_smoke_rate</p>
<p><em>Model_3:</em> crudedeath_rate ~ binge_drink_rate + divorce_rate + mean_poverty_rate + binge_drink_rate:education_rate +mean_unemployment_rate:mean_poverty_rate + mean_poverty_rate:mean_smoke_rate</p>
<p><em>Model_4:</em> crudedeath_rate ~ binge_drink_rate + education_rate + mean_smoke_rate + divorce_rate:education_rate</p>
<p><em>Model_5:</em> crudedeath_rate ~ binge_drink_rate + divorce_rate + education_rate + mean_smoke_rate</p>
<p>In cross validation process, we are going to compare the cross-validated prediction error for these five model and their result with initial full model.</p>
<pre class="r"><code>train_df = sample_n(overall_regression, 41)
test_df = anti_join(overall_regression, train_df)


set.seed(1)
cv_modeling_df = 
  crossv_mc(overall_regression, 5000) %&gt;% 
  mutate(
    train = map(train, as_tibble),
    test = map(test, as_tibble)
  ) %&gt;% 
  mutate(
    model_1 = map(.x = train, ~lm(crudedeath_rate ~ binge_drink_rate + divorce_rate +  mean_unemployment_rate + education_rate + mean_poverty_rate +  mean_smoke_rate + binge_drink_rate:education_rate, data = .x)),
    model_2 = map(.x = train, ~lm(crudedeath_rate ~ mean_poverty_rate + mean_unemployment_rate:mean_poverty_rate + education_rate:mean_poverty_rate + mean_poverty_rate:mean_smoke_rate, data = .x)),
    model_3 = map(.x = train, ~lm(crudedeath_rate ~ binge_drink_rate + divorce_rate + mean_poverty_rate + binge_drink_rate:education_rate +mean_unemployment_rate:mean_poverty_rate + mean_poverty_rate:mean_smoke_rate, data = .x)),
    model_4 = map(.x = train, ~lm(crudedeath_rate ~ binge_drink_rate + education_rate + mean_smoke_rate + divorce_rate:education_rate, data = .x)),
    model_5 = map(.x = train, ~lm(crudedeath_rate ~ binge_drink_rate + divorce_rate + education_rate + mean_smoke_rate, data = .x)),
    model_full = map(.x = train, ~lm(crudedeath_rate ~ binge_drink_rate + divorce_rate + mean_unemployment_rate + education_rate + mean_poverty_rate + mean_smoke_rate + binge_drink_rate * education_rate + mean_unemployment_rate * mean_poverty_rate + education_rate * mean_poverty_rate + education_rate * mean_smoke_rate + mean_poverty_rate * mean_smoke_rate, data = .x))
  ) %&gt;% 
  mutate(
    rmse_model_1 = map2_dbl(.x = model_1, .y = test, ~rmse(model = .x, data = .y)),
    rmse_model_2 = map2_dbl(.x = model_2, .y = test, ~rmse(model = .x, data = .y)),
    rmse_model_3 = map2_dbl(.x = model_3, .y = test, ~rmse(model = .x, data = .y)),
    rmse_model_4 = map2_dbl(.x = model_4, .y = test, ~rmse(model = .x, data = .y)),
    rmse_model_5 = map2_dbl(.x = model_5, .y = test, ~rmse(model = .x, data = .y)),
    rmse_model_full = map2_dbl(.x = model_full, .y = test, ~rmse(model = .x, data = .y))
  )

cv_modeling_output = 
  cv_modeling_df %&gt;% 
  select(.id, starts_with(&quot;rmse&quot;)) %&gt;% 
  pivot_longer(
    rmse_model_1:rmse_model_full,
    names_to = &quot;model&quot;,
    values_to = &quot;rmse&quot;,
    names_prefix = &quot;rmse_&quot;
  ) %&gt;% 
  ggplot(aes(x = model, y = rmse)) +
  geom_violin(aes(fill = model), alpha = 0.5)

cv_modeling_output</code></pre>
<p><img src="regression_us_files/figure-html/unnamed-chunk-20-1.png" width="90%" /></p>
<p><em>Comments:</em></p>
<p>All five models we select are better than the initial model. Model_5 may be slightly better than other four.</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>The better model to explain the variances (from 2015 - 2019) of crude death rate of drug overdose for fifty states and Washington D.C. is model 5.</p>
<p><strong>Model_5:</strong> crudedeath_rate ~ binge_drink_rate + divorce_rate + education_rate + mean_smoke_rate</p>
<pre class="r"><code>summary(stepwise_no_inter) %&gt;% broom::tidy() %&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.4646221</td>
<td align="right">0.3226392</td>
<td align="right">1.440067</td>
<td align="right">0.1567697</td>
</tr>
<tr class="even">
<td align="left">binge_drink_rate</td>
<td align="right">-1.5395071</td>
<td align="right">0.5520224</td>
<td align="right">-2.788849</td>
<td align="right">0.0077258</td>
</tr>
<tr class="odd">
<td align="left">divorce_rate</td>
<td align="right">-1.5061409</td>
<td align="right">0.4402422</td>
<td align="right">-3.421165</td>
<td align="right">0.0013370</td>
</tr>
<tr class="even">
<td align="left">education_rate</td>
<td align="right">2.2751208</td>
<td align="right">0.4591017</td>
<td align="right">4.955592</td>
<td align="right">0.0000107</td>
</tr>
<tr class="odd">
<td align="left">mean_smoke_rate</td>
<td align="right">2.5809509</td>
<td align="right">0.5356159</td>
<td align="right">4.818660</td>
<td align="right">0.0000168</td>
</tr>
</tbody>
</table>
<p><strong>Predictor evaluation:</strong> Binge drink rate and divorce rate are negatively associated with crude death rate of drug overdose. This means states with the higher value of these predictors may have a lower death rate for drug overdose. Education rate and smoke rate are positively associated with crude death rate of drug overdose. This means that states which have higher proportion of population with bachelor’s degree or above, or states with higher prevalence of adult smokers may also have a higher rate of death induced by drug overdose. All four predictors are significant in this models.</p>
<pre class="r"><code>summary(stepwise_no_inter) %&gt;% broom::glance() %&gt;% knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">df</th>
<th align="right">df.residual</th>
<th align="right">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5493662</td>
<td align="right">0.5093098</td>
<td align="right">0.1015012</td>
<td align="right">13.71484</td>
<td align="right">2e-07</td>
<td align="right">4</td>
<td align="right">45</td>
<td align="right">50</td>
</tr>
</tbody>
</table>
<p><strong>Model description:</strong> Overall, this model explains around 50% of the difference of crude death rate of drug overdose among fifty states and Washington D.C.. However, since the sample size we use is quite small(50 + 1 = 51), this model might not be very reliable.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
