<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<<<<<<< HEAD
<title>NYC data analyzing</title>
=======
<title>New York City Data Analyzing</title>
>>>>>>> 7e5ebe4cd30262faf611f70d5adca9e0ab41ef12

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Overview
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="overview.html">Project Overview</a>
    </li>
    <li>
      <a href="usa_analyzing.html">United States Overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="report.html">Report</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    States of Choice
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="CA_data_analyzing.html">California</a>
    </li>
    <li>
      <a href="FL_data_analyzing.html">Florida</a>
    </li>
    <li>
      <a href="NY_data_analyzing.html">New York City</a>
    </li>
    <li>
      <a href="Ohio_data_analyzing.html">Ohio</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://paulawucu.shinyapps.io/shiny_dashboard_upload/">Interactive Maps</a>
</li>
<li>
  <a href="regression_us.html">Regression</a>
</li>
<li>
  <a href="fact.html">Facts About</a>
</li>
<li>
  <a href="https://youtu.be/nDrmCsTRqqs">
    <span class="fa fa-play-circle fa-sm"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/paulawucu/final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<<<<<<< HEAD
<h1 class="title toc-ignore">NYC data analyzing</h1>
=======
<h1 class="title toc-ignore">New York City Data Analyzing</h1>
>>>>>>> 7e5ebe4cd30262faf611f70d5adca9e0ab41ef12

</div>


<pre class="r"><code>drug_overdose = read_csv(&quot;./data/VSRR_Provisional_Drug_Overdose_Death_Counts.csv&quot;) %&gt;% 
  janitor::clean_names()

state_level = c(state.name[1:8], &quot;District of Columbia&quot;, state.name[9:32],&quot;New York City&quot;, state.name[33:50])

drug_overdose_52 = 
  drug_overdose %&gt;% 
  filter(!(state_name %in% c(&quot;United States&quot;))) %&gt;% 
  relocate(state_name) %&gt;% 
  mutate(month = factor(month, levels = month.name),
         year = factor(year),
         state_name = factor(state_name, levels = state_level)) %&gt;% 
  arrange(state_name) %&gt;% 
  group_by(state_name, year) %&gt;% 
  mutate(month = sort(month)) 

nyc_df = 
  drug_overdose_52 %&gt;%
  filter(state_name == &quot;New York City&quot;)

drug_percent_specified = 
  nyc_df %&gt;%
  ungroup() %&gt;% 
  select(year, month, indicator, data_value) %&gt;% 
  filter(indicator == &quot;Percent with drugs specified&quot;)</code></pre>
<div id="by-drug-type" class="section level2">
<h2>By Drug Type</h2>
<p><strong>Number of Drug Overdose Deaths by Drug Categories in NYC</strong></p>
<p>For nyc_drug_overdose_death dataset: The dimension of this dataset is (912, 12). The percentages with drugs specified for each month from 2015-2021 in NYC are all above 98%, hence, the drugs’ specified data are accurate enough and can be used further. However, the data of death counts for specific drug types in the years 2016 and 2017 are missing.</p>
<pre class="r"><code>summarize_nyc_drug = 
  nyc_df %&gt;% 
  ungroup() %&gt;% 
  select(year, month, indicator, data_value) %&gt;% 
  filter(!(indicator %in% c(&quot;Number of Deaths&quot;,&quot;Number of Drug Overdose Deaths&quot;,&quot;Percent with drugs specified&quot;))) %&gt;%
  filter(!(year %in% c(&quot;2016&quot;,&quot;2017&quot;))) %&gt;% 
  mutate(indicator = as.factor(indicator)) %&gt;% 
  mutate(
    indicator = fct_reorder(indicator, data_value)
  ) 

summarize_nyc_drug %&gt;% 
  ggplot(aes(x = indicator, y = data_value, fill = indicator)) +
  geom_violin(alpha = 0.5) +
  scale_x_discrete(labels = c(&quot;Psychostimulants \n with abuse potential \n (T43.6)&quot;, &quot;Methadone \n (T40.3)&quot;, &quot;Natural &amp; \n semi-synthetic  \n opioids \n (T40.2)&quot;, &quot;Natural &amp; semi-\n synthetic opioids, \n incl. methadone \n (T40.2, T40.3)&quot;, &quot;Heroin \n (T40.1)&quot;, &quot;Cocaine \n (T40.5)&quot;, &quot;Synthetic opioids, \n excl. \n methadone \n (T40.4)&quot;, &quot;Natural, \n semi-synthetic, &amp; \n synthetic opioids, \n incl. methadone \n (T40.2-T40.4)&quot;, &quot;Opioids \n (T40.0-T40.4,\n T40.6)&quot;)) +
  guides(fill = guide_legend(nrow = 6, byrow = TRUE)) +
  labs(
    title = &quot;Number of Drug Overdose Deaths by Drug Categories in NYC (2015 - 2021)&quot;,
    x = &quot;Drug Categories&quot;,
    y = &quot;Number of Drug Overdose Deaths&quot;,
    caption = &quot;Data comes from VSRR_Provisional_Drug_Overdose_Death_Counts dataset.&quot;
  )</code></pre>
<p><img src="NY_data_analyzing_files/figure-html/unnamed-chunk-2-1.png" width="90%" /></p>
<p>Based on the above Number of Drug Overdose Deaths by Drug Categories plot, in New York City, from 2015 to 2021, the number of people who have died because of overdoses of opioids(T40.0-T40.4, T40.6) has reached nearly 2,000, which indicates that the cause of the highest number of drug overdose deaths is synthetic opioids. Based on the overall shape and distribution of all drug categories, there are more outliers in opioids(T40.0-T40.4, T40.6), synthetic opioids, excl. methadone(T40.4), and Natural, semi-synthetic, &amp; synthetic opioids, incl. methadone(T40.2-T40.4).</p>
<p><br><br></p>
</div>
<div id="by-year" class="section level2">
<h2>By Year</h2>
<p><strong>Percent of Drug Overdose Deaths over Total Number of Deaths by Year in NYC</strong></p>
<pre class="r"><code>nyc_drug_overdose_death_df =
  nyc_df %&gt;% 
  ungroup() %&gt;% 
  select(year, month, indicator, data_value) %&gt;% 
  filter(indicator %in% c(&quot;Number of Deaths&quot;, &quot;Number of Drug Overdose Deaths&quot;)) %&gt;% 
  pivot_wider(
    names_from = indicator,
    values_from = data_value
  ) %&gt;% 
  janitor::clean_names() %&gt;% 
  group_by(year, month) %&gt;% 
  mutate(
    percent_overdose_death = number_of_drug_overdose_deaths / number_of_deaths
  )

nyc_drug_overdose_death_df %&gt;%
  ungroup() %&gt;% 
  ggplot(aes(x = month, y = percent_overdose_death, color = year)) +
  geom_point() +
  geom_line(aes(group = year)) +
  labs(
    title = &quot;Percent of Drug Overdose Deaths over Total Number of Deaths by Year in NYC&quot;,
    x = &quot;Months&quot;,
    y = &quot;Percent of Drug Overdose Deaths&quot;,
    caption = &quot;Data comes from VSRR_Provisional_Drug_Overdose_Death_Counts dataset from 2015 to 2021).&quot;
  )</code></pre>
<p><img src="NY_data_analyzing_files/figure-html/unnamed-chunk-3-1.png" width="90%" /></p>
<p>Based on the above Percent of Drug Overdose Deaths over Total Number of Deaths by Year plot, in New York City, the year 2015 has the lowest percentage of drug overdose death with a steady performance. In the years 2016 and 2020, both plots have huge oscillations. The percentages of drug overdose death intensely drop in March and Jun in 2016, and May and August in 2020, and rising again in May and August in 2016, and July and September in 2020. And in the years 2017, 2018, and 2019, the percentages are steady across the year. There may be a time lag in data obtained in 2021, hence the data in this year are not reliable.</p>
<pre class="r"><code>nyc_drug_overdose_death_df %&gt;%
  ungroup() %&gt;% 
  ggplot(aes(x = month, y = percent_overdose_death, group = NA, color = year)) +
  geom_point() +
  geom_line() +
  facet_grid(.~ year) +
  labs(
    title = &quot;Percent of Drug Overdose Deaths over Total Number of Deaths by Year in NYC&quot;,
    x = &quot;Months&quot;,
    y = &quot;Percent of Drug Overdose Deaths&quot;,
    caption = &quot;Data comes from VSRR_Provisional_Drug_Overdose_Death_Counts dataset from 2015 to 2021.&quot;
  ) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) </code></pre>
<p><img src="NY_data_analyzing_files/figure-html/unnamed-chunk-4-1.png" width="90%" /></p>
<p>In order to see the trending of percent of drug overdose deaths in the past seven years from 2015 to 2021, we lined up all graphs over the years for comparison. Based on the above scatter plot, we can see that overall the percent of drug overdose deaths shows a tendency to increase by each year. Since there may be a time lag in data obtained in 2021, we ignored the data this year. And the value of the percent of drug overdose deaths has increased from around 0.015 in the year 2015 to around 0.027 in the year 2020.</p>
<p><br><br></p>
</div>
<div id="drug-year" class="section level2">
<h2>Drug ~ Year</h2>
<p><strong>Number of Drug Overdose Deaths with Drug Categories by Year in NYC</strong></p>
<pre class="r"><code>summarize_nyc_drug %&gt;% 
  ggplot(aes(x = year, y = data_value, color = indicator)) +
  geom_point() +
  geom_line(aes(group = indicator)) +
  scale_color_viridis(discrete = TRUE, labels = c(&quot;Psychostimulants with abuse potential (T43.6)&quot;, &quot;Methadone (T40.3)&quot;, &quot;Natural &amp; semi-synthetic opioids (T40.2)&quot;, &quot;Natural &amp; semi-synthetic opioids, incl. methadone (T40.2, T40.3)&quot;, &quot;Heroin (T40.1)&quot;, &quot;Cocaine (T40.5)&quot;, &quot;Synthetic opioids, excl. methadone (T40.4)&quot;, &quot;Natural, semi-synthetic, &amp; synthetic opioids, incl. methadone (T40.2-T40.4)&quot;, &quot;Opioids (T40.0-T40.4,T40.6)&quot;)) +
  guides(color = guide_legend(nrow = 6, byrow = TRUE)) +
  labs(
    title = &quot;Number of Drug Overdose Deaths with Drug Categories by Year in NYC&quot;,
    x = &quot;Drug Categories&quot;,
    y = &quot;Number of Drug Overdose Deaths&quot;,
    caption = &quot;Data comes from VSRR_Provisional_Drug_Overdose_Death_Counts dataset between 2015 and 2021.&quot;
  )</code></pre>
<p><img src="NY_data_analyzing_files/figure-html/unnamed-chunk-5-1.png" width="90%" /></p>
<p>After comparing drug overdose deaths by drug categories and drug overdose deaths by years from 2015 to 2021, now we want to compare the number of drug overdose death both by drug types and by year in New York City. Based on the above scatter plot we can see that the number of death is steadily rising each year for each type of drug. Opioids(T40.0-T40.4, T40.6) has made the highest number of people’s death in 9 types of drug categories since 2015, which indicates that synthetic opioids are the primary cause of people’s death in the case of a drug overdose.</p>
<p><br><br></p>
</div>
<div id="by-age-group-race" class="section level2">
<h2>By Age-group &amp; Race</h2>
<p><strong>age-adjusted drug overdose death rate by race</strong></p>
<pre class="r"><code>ny_drugoverdose_death_by_age = 
  read_csv(&quot;./data/ny_agegroup_race_state_year_99-19.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  #filter(year == (2015:2019)) %&gt;% 
  mutate(county = str_replace(county, &quot; County, NY&quot;, &quot;&quot;),
         ten_year_age_groups = gsub(&quot;years&quot;, &quot;&quot;, ten_year_age_groups)) %&gt;% 
  select(county, year, ten_year_age_groups, race, deaths, population) %&gt;% 
  filter(str_detect(county, &quot;Bronx|Queens|Kings|New York|Richmond&quot;)) %&gt;% 
  mutate(year = factor(year),
         crude_rate = deaths/population * 100000) %&gt;% 
  group_by(race)</code></pre>
<p>Next, we want to compare the age-adjusted drug overdose death rate by race in NYC. In order to examine the relationship between drug overdose death, age-group, and race in NYC. We obtained this <code>ny_agegroup_race_state_year_99-19.csv</code> dataset from CDC wonder and calculated the age-adjusted mortality rate by dividing the number of deaths by the population and multiplying by 100000. The dimension of this dataset is (609, 7).</p>
<pre class="r"><code>ny_drugoverdose_death_by_age %&gt;% 
  ggplot(aes(x = ten_year_age_groups, y = crude_rate, fill = county)) +
  geom_boxplot(outlier.shape = NA, alpha = 0.5) +
  facet_grid(~race) +
  labs(
    title = &quot;Age-Adjusted Drug Overdose Mortality Rate by Race in NYC&quot;,
    x = &quot;Age Groups&quot;,
    y = &quot;Age-Adjusted Mortality Rate \n(per 100,000)&quot;,
    caption = &quot;Source: NYC drug overdose death counts from CDC, 2015-2019&quot;
  )</code></pre>
<p><img src="NY_data_analyzing_files/figure-html/unnamed-chunk-7-1.png" width="90%" /></p>
<p>Based on the above age-adjusted drug overdose death rate by race plot, we can see that for black or African Americans, people among age 55-64 have the highest death rate; and for white, people among age 25-34 have the highest death rate. Black or African Americans have the highest death rate in New York county, and white people have the highest death rate in Richmond county.</p>
<p><br><br></p>
</div>
<div id="by-income" class="section level2">
<h2>By Income</h2>
<p><strong>Median Household Income: New York vs. The U.S</strong></p>
<pre class="r"><code>ny_eco_df = 
  read_csv(&quot;./data/median_household_income_ny.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  select(year, household_income_by_race, household_income_by_race_moe, geography) %&gt;% 
  filter(year &gt;= &quot;2015&quot;,
         !(geography  %in% c(&quot;New York-Newark-Jersey City, NY-NJ-PA&quot;, &quot;New York&quot;))) %&gt;% 
  mutate( 
    geography = str_replace(geography, &quot;New York, NY&quot;, &quot;New York City&quot;),
    geography = str_replace(geography, &quot;, NY&quot;, &quot;&quot;),
    year = factor(year))</code></pre>
<p>For nyc_median_household_income dataset: In order to examine the relationship between drug overdose death and income in NYC. We obtained this <code>median_household_income_ny.csv</code> dataset from DATA USA, chose years after 2015, and selected all five counties in New York City. The dimension of this dataset is (35, 4).</p>
<pre class="r"><code>ny_eco_df %&gt;% 
  mutate(text_label = str_c(&quot;Year: &quot;, year, &quot;\nMedian Household Income: $&quot;, household_income_by_race, 
                            &quot;\nMargin of error: ± $&quot;, household_income_by_race_moe)) %&gt;% 
  plot_ly(
    x = ~year, y = ~household_income_by_race, color = ~geography, text = ~text_label, 
    alpha = 0.5, type = &quot;scatter&quot;, mode = &quot;markers+lines&quot;, colors = &quot;viridis&quot;,error_y = ~list(array = household_income_by_race_moe)) %&gt;% 
  layout(
    title = &quot;Median Household Income: New York vs. The U.S&quot;,
         xaxis = list(title = &quot;Year&quot;),
         yaxis = list(title = &quot;Median Household Income&quot;))</code></pre>
<<<<<<< HEAD
<<<<<<< HEAD
<div id="htmlwidget-e072145059017b996148" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-e072145059017b996148">{"x":{"visdat":{"4b7c422fef85":["function () ","plotlyVisDat"]},"cur_data":"4b7c422fef85","attrs":{"4b7c422fef85":{"x":{},"y":{},"text":{},"mode":"markers+lines","error_y":{},"color":{},"colors":"viridis","alpha":0.5,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Median Household Income: New York vs. The U.S","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Median Household Income"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2019","2018","2017","2016","2015"],"y":[41432,38467,37397,37525,35176],"text":["Year: 2019<br />Median Household Income: $41432<br />Margin of error: ± $1090","Year: 2018<br />Median Household Income: $38467<br />Margin of error: ± $1864","Year: 2017<br />Median Household Income: $37397<br />Margin of error: ± $1444","Year: 2016<br />Median Household Income: $37525<br />Margin of error: ± $1266","Year: 2015<br />Median Household Income: $35176<br />Margin of error: ± $1392"],"mode":"markers+lines","error_y":{"color":"rgba(68,1,84,0.5)","array":[118,1090,1343,3322,1832]},"type":"scatter","name":"Bronx County","marker":{"color":"rgba(68,1,84,0.5)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,0.5)"},"error_x":{"color":"rgba(68,1,84,0.5)"},"line":{"color":"rgba(68,1,84,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[66937,61220,56942,55150,51141],"text":["Year: 2019<br />Median Household Income: $66937<br />Margin of error: ± $1343","Year: 2018<br />Median Household Income: $61220<br />Margin of error: ± $1083","Year: 2017<br />Median Household Income: $56942<br />Margin of error: ± $1151","Year: 2016<br />Median Household Income: $55150<br />Margin of error: ± $1015","Year: 2015<br />Median Household Income: $51141<br />Margin of error: ± $566"],"mode":"markers+lines","error_y":{"color":"rgba(68,58,131,0.5)","array":[5711,1121,94,1864,1083]},"type":"scatter","name":"Kings County","marker":{"color":"rgba(68,58,131,0.5)","line":{"color":"rgba(68,58,131,1)"}},"textfont":{"color":"rgba(68,58,131,0.5)"},"error_x":{"color":"rgba(68,58,131,0.5)"},"line":{"color":"rgba(68,58,131,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[69407,63799,60879,58856,55752],"text":["Year: 2019<br />Median Household Income: $69407<br />Margin of error: ± $1121","Year: 2018<br />Median Household Income: $63799<br />Margin of error: ± $1118","Year: 2017<br />Median Household Income: $60879<br />Margin of error: ± $500","Year: 2016<br />Median Household Income: $58856<br />Margin of error: ± $1105","Year: 2015<br />Median Household Income: $55752<br />Margin of error: ± $592"],"mode":"markers+lines","error_y":{"color":"rgba(49,104,142,0.5)","array":[3480,1781,5148,1118,86]},"type":"scatter","name":"New York City","marker":{"color":"rgba(49,104,142,0.5)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,0.5)"},"error_x":{"color":"rgba(49,104,142,0.5)"},"line":{"color":"rgba(49,104,142,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[93651,85066,85071,77559,75575],"text":["Year: 2019<br />Median Household Income: $93651<br />Margin of error: ± $3322","Year: 2018<br />Median Household Income: $85066<br />Margin of error: ± $3480","Year: 2017<br />Median Household Income: $85071<br />Margin of error: ± $3520","Year: 2016<br />Median Household Income: $77559<br />Margin of error: ± $2469","Year: 2015<br />Median Household Income: $75575<br />Margin of error: ± $2566"],"mode":"markers+lines","error_y":{"color":"rgba(33,144,141,0.5)","array":[1444,1151,3520,1327,2788]},"type":"scatter","name":"New York County","marker":{"color":"rgba(33,144,141,0.5)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,0.5)"},"error_x":{"color":"rgba(33,144,141,0.5)"},"line":{"color":"rgba(33,144,141,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[73696,69320,64509,62207,60422],"text":["Year: 2019<br />Median Household Income: $73696<br />Margin of error: ± $1832","Year: 2018<br />Median Household Income: $69320<br />Margin of error: ± $1781","Year: 2017<br />Median Household Income: $64509<br />Margin of error: ± $1327","Year: 2016<br />Median Household Income: $62207<br />Margin of error: ± $1151","Year: 2015<br />Median Household Income: $60422<br />Margin of error: ± $723"],"mode":"markers+lines","error_y":{"color":"rgba(53,183,121,0.5)","array":[500,115,1266,1015,2469]},"type":"scatter","name":"Queens County","marker":{"color":"rgba(53,183,121,0.5)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,0.5)"},"error_x":{"color":"rgba(53,183,121,0.5)"},"line":{"color":"rgba(53,183,121,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[89821,82166,79201,77197,71622],"text":["Year: 2019<br />Median Household Income: $89821<br />Margin of error: ± $5711","Year: 2018<br />Median Household Income: $82166<br />Margin of error: ± $5148","Year: 2017<br />Median Household Income: $79201<br />Margin of error: ± $2788","Year: 2016<br />Median Household Income: $77197<br />Margin of error: ± $4465","Year: 2015<br />Median Household Income: $71622<br />Margin of error: ± $2532"],"mode":"markers+lines","error_y":{"color":"rgba(143,214,68,0.5)","array":[1151,4465,1105,85,1392]},"type":"scatter","name":"Richmond County","marker":{"color":"rgba(143,214,68,0.5)","line":{"color":"rgba(143,214,68,1)"}},"textfont":{"color":"rgba(143,214,68,0.5)"},"error_x":{"color":"rgba(143,214,68,0.5)"},"line":{"color":"rgba(143,214,68,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[65712,61937,60336,57617,55775],"text":["Year: 2019<br />Median Household Income: $65712<br />Margin of error: ± $118","Year: 2018<br />Median Household Income: $61937<br />Margin of error: ± $94","Year: 2017<br />Median Household Income: $60336<br />Margin of error: ± $86","Year: 2016<br />Median Household Income: $57617<br />Margin of error: ± $115","Year: 2015<br />Median Household Income: $55775<br />Margin of error: ± $85"],"mode":"markers+lines","error_y":{"color":"rgba(253,231,37,0.5)","array":[566,2566,723,2532,592]},"type":"scatter","name":"United States","marker":{"color":"rgba(253,231,37,0.5)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,0.5)"},"error_x":{"color":"rgba(253,231,37,0.5)"},"line":{"color":"rgba(253,231,37,0.5)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>From the above plotly, we can see that all the median household incomes in New York counties are higher than the median household income in the overall United States. And New York county has the highest median household income in all five counties in NYC.</p>
=======
<div id="htmlwidget-9bc07df227d33e7fce65" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9bc07df227d33e7fce65">{"x":{"visdat":{"b74a66dbfba2":["function () ","plotlyVisDat"]},"cur_data":"b74a66dbfba2","attrs":{"b74a66dbfba2":{"x":{},"y":{},"text":{},"mode":"markers+lines","error_y":{},"color":{},"colors":"viridis","alpha":0.5,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Median Household Income: New York vs. The U.S","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Median Household Income"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2019","2018","2017","2016","2015"],"y":[41432,38467,37397,37525,35176],"text":["Year: 2019<br />Median Household Income: $41432<br />Margin of error: ± $1090","Year: 2018<br />Median Household Income: $38467<br />Margin of error: ± $1864","Year: 2017<br />Median Household Income: $37397<br />Margin of error: ± $1444","Year: 2016<br />Median Household Income: $37525<br />Margin of error: ± $1266","Year: 2015<br />Median Household Income: $35176<br />Margin of error: ± $1392"],"mode":"markers+lines","error_y":{"color":"rgba(68,1,84,0.5)","array":[118,1090,1343,3322,1832]},"type":"scatter","name":"Bronx County","marker":{"color":"rgba(68,1,84,0.5)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,0.5)"},"error_x":{"color":"rgba(68,1,84,0.5)"},"line":{"color":"rgba(68,1,84,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[66937,61220,56942,55150,51141],"text":["Year: 2019<br />Median Household Income: $66937<br />Margin of error: ± $1343","Year: 2018<br />Median Household Income: $61220<br />Margin of error: ± $1083","Year: 2017<br />Median Household Income: $56942<br />Margin of error: ± $1151","Year: 2016<br />Median Household Income: $55150<br />Margin of error: ± $1015","Year: 2015<br />Median Household Income: $51141<br />Margin of error: ± $566"],"mode":"markers+lines","error_y":{"color":"rgba(68,58,131,0.5)","array":[5711,1121,94,1864,1083]},"type":"scatter","name":"Kings County","marker":{"color":"rgba(68,58,131,0.5)","line":{"color":"rgba(68,58,131,1)"}},"textfont":{"color":"rgba(68,58,131,0.5)"},"error_x":{"color":"rgba(68,58,131,0.5)"},"line":{"color":"rgba(68,58,131,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[69407,63799,60879,58856,55752],"text":["Year: 2019<br />Median Household Income: $69407<br />Margin of error: ± $1121","Year: 2018<br />Median Household Income: $63799<br />Margin of error: ± $1118","Year: 2017<br />Median Household Income: $60879<br />Margin of error: ± $500","Year: 2016<br />Median Household Income: $58856<br />Margin of error: ± $1105","Year: 2015<br />Median Household Income: $55752<br />Margin of error: ± $592"],"mode":"markers+lines","error_y":{"color":"rgba(49,104,142,0.5)","array":[3480,1781,5148,1118,86]},"type":"scatter","name":"New York City","marker":{"color":"rgba(49,104,142,0.5)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,0.5)"},"error_x":{"color":"rgba(49,104,142,0.5)"},"line":{"color":"rgba(49,104,142,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[93651,85066,85071,77559,75575],"text":["Year: 2019<br />Median Household Income: $93651<br />Margin of error: ± $3322","Year: 2018<br />Median Household Income: $85066<br />Margin of error: ± $3480","Year: 2017<br />Median Household Income: $85071<br />Margin of error: ± $3520","Year: 2016<br />Median Household Income: $77559<br />Margin of error: ± $2469","Year: 2015<br />Median Household Income: $75575<br />Margin of error: ± $2566"],"mode":"markers+lines","error_y":{"color":"rgba(33,144,141,0.5)","array":[1444,1151,3520,1327,2788]},"type":"scatter","name":"New York County","marker":{"color":"rgba(33,144,141,0.5)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,0.5)"},"error_x":{"color":"rgba(33,144,141,0.5)"},"line":{"color":"rgba(33,144,141,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[73696,69320,64509,62207,60422],"text":["Year: 2019<br />Median Household Income: $73696<br />Margin of error: ± $1832","Year: 2018<br />Median Household Income: $69320<br />Margin of error: ± $1781","Year: 2017<br />Median Household Income: $64509<br />Margin of error: ± $1327","Year: 2016<br />Median Household Income: $62207<br />Margin of error: ± $1151","Year: 2015<br />Median Household Income: $60422<br />Margin of error: ± $723"],"mode":"markers+lines","error_y":{"color":"rgba(53,183,121,0.5)","array":[500,115,1266,1015,2469]},"type":"scatter","name":"Queens County","marker":{"color":"rgba(53,183,121,0.5)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,0.5)"},"error_x":{"color":"rgba(53,183,121,0.5)"},"line":{"color":"rgba(53,183,121,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[89821,82166,79201,77197,71622],"text":["Year: 2019<br />Median Household Income: $89821<br />Margin of error: ± $5711","Year: 2018<br />Median Household Income: $82166<br />Margin of error: ± $5148","Year: 2017<br />Median Household Income: $79201<br />Margin of error: ± $2788","Year: 2016<br />Median Household Income: $77197<br />Margin of error: ± $4465","Year: 2015<br />Median Household Income: $71622<br />Margin of error: ± $2532"],"mode":"markers+lines","error_y":{"color":"rgba(143,214,68,0.5)","array":[1151,4465,1105,85,1392]},"type":"scatter","name":"Richmond County","marker":{"color":"rgba(143,214,68,0.5)","line":{"color":"rgba(143,214,68,1)"}},"textfont":{"color":"rgba(143,214,68,0.5)"},"error_x":{"color":"rgba(143,214,68,0.5)"},"line":{"color":"rgba(143,214,68,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[65712,61937,60336,57617,55775],"text":["Year: 2019<br />Median Household Income: $65712<br />Margin of error: ± $118","Year: 2018<br />Median Household Income: $61937<br />Margin of error: ± $94","Year: 2017<br />Median Household Income: $60336<br />Margin of error: ± $86","Year: 2016<br />Median Household Income: $57617<br />Margin of error: ± $115","Year: 2015<br />Median Household Income: $55775<br />Margin of error: ± $85"],"mode":"markers+lines","error_y":{"color":"rgba(253,231,37,0.5)","array":[566,2566,723,2532,592]},"type":"scatter","name":"United States","marker":{"color":"rgba(253,231,37,0.5)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,0.5)"},"error_x":{"color":"rgba(253,231,37,0.5)"},"line":{"color":"rgba(253,231,37,0.5)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
=======
<div id="htmlwidget-819172403bbce8439717" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-819172403bbce8439717">{"x":{"visdat":{"f8822d2cf2a2":["function () ","plotlyVisDat"]},"cur_data":"f8822d2cf2a2","attrs":{"f8822d2cf2a2":{"x":{},"y":{},"text":{},"mode":"markers+lines","error_y":{},"color":{},"colors":"viridis","alpha":0.5,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Median Household Income: New York vs. The U.S","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Median Household Income"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2019","2018","2017","2016","2015"],"y":[41432,38467,37397,37525,35176],"text":["Year: 2019<br />Median Household Income: $41432<br />Margin of error: ± $1090","Year: 2018<br />Median Household Income: $38467<br />Margin of error: ± $1864","Year: 2017<br />Median Household Income: $37397<br />Margin of error: ± $1444","Year: 2016<br />Median Household Income: $37525<br />Margin of error: ± $1266","Year: 2015<br />Median Household Income: $35176<br />Margin of error: ± $1392"],"mode":"markers+lines","error_y":{"color":"rgba(68,1,84,0.5)","array":[118,1090,1343,3322,1832]},"type":"scatter","name":"Bronx County","marker":{"color":"rgba(68,1,84,0.5)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,0.5)"},"error_x":{"color":"rgba(68,1,84,0.5)"},"line":{"color":"rgba(68,1,84,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[66937,61220,56942,55150,51141],"text":["Year: 2019<br />Median Household Income: $66937<br />Margin of error: ± $1343","Year: 2018<br />Median Household Income: $61220<br />Margin of error: ± $1083","Year: 2017<br />Median Household Income: $56942<br />Margin of error: ± $1151","Year: 2016<br />Median Household Income: $55150<br />Margin of error: ± $1015","Year: 2015<br />Median Household Income: $51141<br />Margin of error: ± $566"],"mode":"markers+lines","error_y":{"color":"rgba(68,58,131,0.5)","array":[5711,1121,94,1864,1083]},"type":"scatter","name":"Kings County","marker":{"color":"rgba(68,58,131,0.5)","line":{"color":"rgba(68,58,131,1)"}},"textfont":{"color":"rgba(68,58,131,0.5)"},"error_x":{"color":"rgba(68,58,131,0.5)"},"line":{"color":"rgba(68,58,131,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[69407,63799,60879,58856,55752],"text":["Year: 2019<br />Median Household Income: $69407<br />Margin of error: ± $1121","Year: 2018<br />Median Household Income: $63799<br />Margin of error: ± $1118","Year: 2017<br />Median Household Income: $60879<br />Margin of error: ± $500","Year: 2016<br />Median Household Income: $58856<br />Margin of error: ± $1105","Year: 2015<br />Median Household Income: $55752<br />Margin of error: ± $592"],"mode":"markers+lines","error_y":{"color":"rgba(49,104,142,0.5)","array":[3480,1781,5148,1118,86]},"type":"scatter","name":"New York City","marker":{"color":"rgba(49,104,142,0.5)","line":{"color":"rgba(49,104,142,1)"}},"textfont":{"color":"rgba(49,104,142,0.5)"},"error_x":{"color":"rgba(49,104,142,0.5)"},"line":{"color":"rgba(49,104,142,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[93651,85066,85071,77559,75575],"text":["Year: 2019<br />Median Household Income: $93651<br />Margin of error: ± $3322","Year: 2018<br />Median Household Income: $85066<br />Margin of error: ± $3480","Year: 2017<br />Median Household Income: $85071<br />Margin of error: ± $3520","Year: 2016<br />Median Household Income: $77559<br />Margin of error: ± $2469","Year: 2015<br />Median Household Income: $75575<br />Margin of error: ± $2566"],"mode":"markers+lines","error_y":{"color":"rgba(33,144,141,0.5)","array":[1444,1151,3520,1327,2788]},"type":"scatter","name":"New York County","marker":{"color":"rgba(33,144,141,0.5)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,0.5)"},"error_x":{"color":"rgba(33,144,141,0.5)"},"line":{"color":"rgba(33,144,141,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[73696,69320,64509,62207,60422],"text":["Year: 2019<br />Median Household Income: $73696<br />Margin of error: ± $1832","Year: 2018<br />Median Household Income: $69320<br />Margin of error: ± $1781","Year: 2017<br />Median Household Income: $64509<br />Margin of error: ± $1327","Year: 2016<br />Median Household Income: $62207<br />Margin of error: ± $1151","Year: 2015<br />Median Household Income: $60422<br />Margin of error: ± $723"],"mode":"markers+lines","error_y":{"color":"rgba(53,183,121,0.5)","array":[500,115,1266,1015,2469]},"type":"scatter","name":"Queens County","marker":{"color":"rgba(53,183,121,0.5)","line":{"color":"rgba(53,183,121,1)"}},"textfont":{"color":"rgba(53,183,121,0.5)"},"error_x":{"color":"rgba(53,183,121,0.5)"},"line":{"color":"rgba(53,183,121,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[89821,82166,79201,77197,71622],"text":["Year: 2019<br />Median Household Income: $89821<br />Margin of error: ± $5711","Year: 2018<br />Median Household Income: $82166<br />Margin of error: ± $5148","Year: 2017<br />Median Household Income: $79201<br />Margin of error: ± $2788","Year: 2016<br />Median Household Income: $77197<br />Margin of error: ± $4465","Year: 2015<br />Median Household Income: $71622<br />Margin of error: ± $2532"],"mode":"markers+lines","error_y":{"color":"rgba(143,214,68,0.5)","array":[1151,4465,1105,85,1392]},"type":"scatter","name":"Richmond County","marker":{"color":"rgba(143,214,68,0.5)","line":{"color":"rgba(143,214,68,1)"}},"textfont":{"color":"rgba(143,214,68,0.5)"},"error_x":{"color":"rgba(143,214,68,0.5)"},"line":{"color":"rgba(143,214,68,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[65712,61937,60336,57617,55775],"text":["Year: 2019<br />Median Household Income: $65712<br />Margin of error: ± $118","Year: 2018<br />Median Household Income: $61937<br />Margin of error: ± $94","Year: 2017<br />Median Household Income: $60336<br />Margin of error: ± $86","Year: 2016<br />Median Household Income: $57617<br />Margin of error: ± $115","Year: 2015<br />Median Household Income: $55775<br />Margin of error: ± $85"],"mode":"markers+lines","error_y":{"color":"rgba(253,231,37,0.5)","array":[566,2566,723,2532,592]},"type":"scatter","name":"United States","marker":{"color":"rgba(253,231,37,0.5)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,0.5)"},"error_x":{"color":"rgba(253,231,37,0.5)"},"line":{"color":"rgba(253,231,37,0.5)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
>>>>>>> 98f918d6a88dc28b864e1af0a8ff75c5b62a478c
<p>From the above plotly, we can see that all the median household incomes in New York counties are higher than the median household income in the overall United States. And New York county has the highest median household income in all five counties in NYC. <br></p>
>>>>>>> 7e5ebe4cd30262faf611f70d5adca9e0ab41ef12
<p><strong>Income vs. Percent of Drug Overdose Death by Year in NYC</strong></p>
<pre class="r"><code>income_drug_df_ny = 
  nyc_drug_overdose_death_df %&gt;% 
    ungroup() %&gt;% 
    group_by(year) %&gt;% 
    summarize(overdose_death_rate = sum(number_of_drug_overdose_deaths)/sum(number_of_deaths)) %&gt;% 
    inner_join(., ny_eco_df %&gt;% filter(geography %in% &quot;New York City&quot;))

year_death = 
  income_drug_df_ny %&gt;% 
  ggplot(aes(x = year, y = overdose_death_rate, group = NA)) +
  geom_point() +
  geom_line() +
  ggtitle(&#39;Drug Overdose Death Rate by Year&#39;) +
  labs(
    x = &quot;Year&quot;,
    y = &quot;Overdose Death Rate&quot;
  )

income_year = 
  income_drug_df_ny %&gt;% 
  ggplot(aes(x = year, y = household_income_by_race, group = NA)) +
  geom_point() +
  geom_line() +
  ggtitle(&#39;Income by Year&#39;) +
  labs(
    x = &quot;Year&quot;,
    y = &quot;Household Income&quot;
  )

smooth = 
  income_drug_df_ny %&gt;% 
  ggplot(aes(x = household_income_by_race, y = overdose_death_rate, group = NA)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;royalblue4&quot;) +
  ggtitle(&#39;Drug Overdose Death Rate vs. Income&#39;) +
   labs(
    x = &quot;Household Income&quot;,
    y = &quot;Overdose Death Rate&quot;
  )

(year_death + income_year)/smooth</code></pre>
<p><img src="NY_data_analyzing_files/figure-html/unnamed-chunk-10-1.png" width="90%" /></p>
<p>Based on the above income vs. percent of drug overdose death by year, we can see that in NYC, the overdose death rate and household income are positively correlated. People with a higher income would have a higher drug overdose death rate.</p>
<p><br><br></p>
</div>
<div id="counties-change" class="section level2">
<h2>Counties change</h2>
<pre class="r"><code>ny_county_df = 
  read_csv(&quot;./data/NCHS_-_Drug_Poisoning_Mortality_by_County__United_States.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  filter(state %in% &quot;New York&quot;) %&gt;% 
  select(year, county, population, model_based_death_rate) %&gt;% 
  rename(death_rate = model_based_death_rate) %&gt;% 
  mutate(
    county = str_replace(county, &quot;County, NY&quot;, &quot;&quot;)) %&gt;% 
  mutate(year = factor(year),
         county = str_to_lower(county)) %&gt;% 
  filter(str_detect(county, &quot;bronx|queens|kings|new york|richmond&quot;)) %&gt;% 
  mutate(county = str_replace(county, &quot; $&quot;, &quot;&quot;)) %&gt;% 
  relocate(county)


data(county.fips)
nyc_fip = county.fips %&gt;% 
  filter(str_detect(polyname, &quot;new york&quot;)) %&gt;% 
  mutate(
    polyname = str_replace(polyname, &quot;new york,&quot;, &quot;&quot;)) %&gt;% 
  filter(str_detect(polyname, &quot;bronx|queens|kings|new york|richmond&quot;)) %&gt;% 
  rename(county = polyname) %&gt;% 
  as.tibble()

ny_county_df = left_join(ny_county_df,nyc_fip, by = &quot;county&quot;)


highlight_county = function(county_fips)
{
  data(county.map, package=&quot;choroplethrMaps&quot;, envir=environment())
  df = county.map[county.map$region %in% county_fips, ]
  geom_polygon(data=df, aes(long, lat, group = group), color = &quot;yellow&quot;, fill = NA, size = 1)
}
add_text_county = function(county_fips){
  data(county.map, package=&quot;choroplethrMaps&quot;, envir=environment())
  df = county.map[county.map$region %in% county_fips, ]
  #geom_text(data=df, aes(mean(long), mean(lat), label = paste0(str_to_title(pull(county_fips, county)), &quot; County\n&quot;, pull(county_fips, death_rate))), color = &quot;white&quot;)
  geom_label(data=df, aes(mean(long), mean(lat), label = paste0(str_to_title(pull(county_fips, county)), &quot; County\nDR: &quot;, round(pull(county_fips, death_rate),2))), fill = &quot;white&quot;, size = 3)
}</code></pre>
<p>Based on the changes of drug overdose death rates over counties by an interval of 5 years, we can see that in the year 2003, the highest drug overdose death rates occurred in New York county. In the years 2008 and 2013, the highest drug overdose death rates occurred in Richmond county. And in the year 2018, the highest drug overdose death rates occurred in Bronx county.</p>
<div id="counties-change-5-yr-interval" class="section level3 tabset">
<h3 class="tabset">Counties change, 5-yr interval</h3>
<div id="section" class="section level4">
<h4>2003</h4>
<pre class="r"><code>year_select = 2003
start_county_df = ny_county_df %&gt;% 
  select(county, year, death_rate, fips) %&gt;% 
  filter(year == year_select)

start_deathrate_df = 
  start_county_df %&gt;%
  rename(region = fips,
        value = death_rate) %&gt;% 
  select(value, region)

county_choropleth(start_deathrate_df, title = &quot;Drug Overdose Death Rates of Counties in New York City in 2003&quot;,
                    legend = &quot;Death Rates&quot;,
                    county_zoom = start_deathrate_df$region) +
highlight_county(start_county_df[which.max(pull(start_county_df, death_rate)),]) +
add_text_county(start_county_df[which.max(pull(start_county_df, death_rate)),])</code></pre>
<p><img src="NY_data_analyzing_files/figure-html/unnamed-chunk-12-1.png" width="90%" /></p>
</div>
<div id="section-1" class="section level4">
<h4>2008</h4>
<pre class="r"><code>year_select = 2008
start_county_df = ny_county_df %&gt;% 
  select(county, year, death_rate, fips) %&gt;% 
  filter(year == year_select)

start_deathrate_df = 
  start_county_df %&gt;%
  rename(region = fips,
        value = death_rate) %&gt;% 
  select(value, region)

county_choropleth(start_deathrate_df, title = &quot;Drug Overdose Death Rates of Counties in New York City in 2008&quot;,
                    legend = &quot;Death Rates&quot;,
                    county_zoom = start_deathrate_df$region) +
highlight_county(start_county_df[which.max(pull(start_county_df, death_rate)),]) +
add_text_county(start_county_df[which.max(pull(start_county_df, death_rate)),])</code></pre>
<p><img src="NY_data_analyzing_files/figure-html/unnamed-chunk-13-1.png" width="90%" /></p>
</div>
<div id="section-2" class="section level4">
<h4>2013</h4>
<pre class="r"><code>year_select = 2013
start_county_df = ny_county_df %&gt;% 
  select(county, year, death_rate, fips) %&gt;% 
  filter(year == year_select)

start_deathrate_df = 
  start_county_df %&gt;%
  rename(region = fips,
        value = death_rate) %&gt;% 
  select(value, region)

county_choropleth(start_deathrate_df, title = &quot;Drug Overdose Death Rates of Counties in New York City in 2013&quot;,
                    legend = &quot;Death Rates&quot;,
                    county_zoom = start_deathrate_df$region) +
highlight_county(start_county_df[which.max(pull(start_county_df, death_rate)),]) +
add_text_county(start_county_df[which.max(pull(start_county_df, death_rate)),])</code></pre>
<p><img src="NY_data_analyzing_files/figure-html/unnamed-chunk-14-1.png" width="90%" /></p>
</div>
<div id="section-3" class="section level4">
<h4>2018</h4>
<p><img src="NY_data_analyzing_files/figure-html/unnamed-chunk-15-1.png" width="90%" /></p>
<p>Back to <a href="index.html">homepage</a></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
