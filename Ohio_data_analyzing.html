<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Ohio Data analyzing</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Overview
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="overview.html">Project Overview</a>
    </li>
    <li>
      <a href="usa_analyzing.html">United States Overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="report.html">Report</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    States of Choice
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="CA_data_analyzing.html">California</a>
    </li>
    <li>
      <a href="FL_data_analyzing.html">Florida</a>
    </li>
    <li>
      <a href="NY_data_analyzing.html">New York City</a>
    </li>
    <li>
      <a href="Ohio_data_analyzing.html">Ohio</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://paulawucu.shinyapps.io/shiny_dashboard_upload/">Interactive Maps</a>
</li>
<li>
  <a href="regression_us.html">Regression</a>
</li>
<li>
  <a href="fact.html">Facts About</a>
</li>
<li>
  <a href="https://youtu.be/nDrmCsTRqqs">
    <span class="fa fa-play-circle fa-sm"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/paulawucu/final_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Ohio Data analyzing</h1>

</div>


<p><strong>Import the Libraries and Data Cleaning</strong></p>
<pre class="r"><code>drug_overdose = read_csv(&quot;./data/VSRR_Provisional_Drug_Overdose_Death_Counts.csv&quot;) %&gt;% 
  janitor::clean_names()

state_level = c(state.name[1:8], &quot;District of Columbia&quot;, state.name[9:32],&quot;New York City&quot;, state.name[33:50])

drug_overdose_52 = 
  drug_overdose %&gt;% 
  filter(!(state_name %in% c(&quot;United States&quot;))) %&gt;% 
  relocate(state_name) %&gt;% 
  mutate(month = factor(month, levels = month.name), # change month and year to factor
         year = factor(year),
         state_name = factor(state_name, levels = state_level)) %&gt;% 
  arrange(state_name) %&gt;% 
  group_by(state_name, year) %&gt;% 
  mutate(month = sort(month)) 

drug_overdose_death = 
  drug_overdose_52 %&gt;% 
  select(-c(state, footnote_symbol, percent_complete, period, percent_pending_investigation, predicted_value)) %&gt;% 
  filter(indicator %in% c(&quot;Number of Deaths&quot;, &quot;Percent with drugs specified&quot;, &quot;Number of Drug Overdose Deaths&quot;))</code></pre>
<pre class="r"><code>Ohio_death = 
  drug_overdose_52 %&gt;% 
  filter(state_name %in% &quot;Ohio&quot;,
         indicator %in%  c(&quot;Number of Deaths&quot;, &quot;Number of Drug Overdose Deaths&quot;)) %&gt;% 
  select(year, month, indicator, deaths = data_value) %&gt;% 
  pivot_wider(
    names_from = indicator,
    values_from = deaths
  ) %&gt;% 
  janitor::clean_names() %&gt;% 
  group_by(year, month) %&gt;% 
  mutate(
    percent_overdose_death = number_of_drug_overdose_deaths / number_of_deaths
  )%&gt;% 
mutate(year = factor(year))</code></pre>
<div id="by-drug-type" class="section level2">
<h2>By Drug Type</h2>
<pre class="r"><code>Ohio_df = 
  drug_categories %&gt;% 
  filter(state_name %in% c(&quot;Ohio&quot;)) 
ggplot(Ohio_df, aes(x = indicator, y = data_value, fill = indicator)) +
  geom_violin(alpha = 0.5) +
  scale_x_discrete(labels = c(&quot;Psychostimulants \n with abuse potential \n (T43.6)&quot;, &quot;Methadone \n (T40.3)&quot;, &quot;Natural &amp; \n semi-synthetic  \n opioids \n (T40.2)&quot;, &quot;Natural &amp; semi-\n synthetic opioids, \n incl. methadone \n (T40.2, T40.3)&quot;, &quot;Heroin \n (T40.1)&quot;, &quot;Cocaine \n (T40.5)&quot;, &quot;Synthetic opioids, \n excl. \n methadone \n (T40.4)&quot;, &quot;Natural, \n semi-synthetic, &amp; \n synthetic opioids, \n incl. methadone \n (T40.2-T40.4)&quot;, &quot;Opioids \n (T40.0-T40.4,\n T40.6)&quot;)) +
  guides(fill = guide_legend(nrow = 6, byrow = TRUE)) +
  labs(
    title = &quot;OH Number of Drug Overdose Deaths with Drug Categories (2015 - 2021)&quot;,
    x = &quot;Drug Categories&quot;,
    y = &quot;Number of Drug Overdose Deaths&quot;,
    caption = &quot;Data comes from VSRR_Provisional_Drug_Overdose_Death_Counts dataset.&quot;
  ) </code></pre>
<p><img src="Ohio_data_analyzing_files/figure-html/unnamed-chunk-6-1.png" width="90%" /> From this graph we can see that highest drug overdose death for Ohio is caused by Cocaine, Synthetic opioids and opioids.</p>
<p><br><br></p>
</div>
<div id="by-year" class="section level2">
<h2>By Year</h2>
<pre class="r"><code>oh_death_by_year = 
  drug_overdose_52 %&gt;% 
  filter(state_name %in% c(&quot;Ohio&quot;)) %&gt;% 
  ungroup() %&gt;% 
  select(year, month, indicator, data_value) %&gt;% 
  filter(indicator %in% c(&quot;Number of Deaths&quot;, &quot;Number of Drug Overdose Deaths&quot;)) %&gt;% 
  pivot_wider(
    names_from = indicator,
    values_from = data_value
  ) %&gt;% 
  janitor::clean_names() %&gt;% 
  group_by(year, month) %&gt;% 
  mutate(
    percent_overdose_death = number_of_drug_overdose_deaths / number_of_deaths
  )

oh_death_by_year %&gt;%
  ungroup() %&gt;% 
  ggplot(aes(x = month, y = percent_overdose_death, color = year)) +
  geom_point() +
  geom_line(aes(group = year)) +
  labs(
    title = &quot;Percent of Drug Overdose Deaths over Total Number of Deaths by Year in OH&quot;,
    x = &quot;Months&quot;,
    y = &quot;Percent of Drug Overdose Deaths&quot;,
    caption = &quot;Data comes from VSRR_Provisional_Drug_Overdose_Death_Counts dataset from 2015 to 2021).&quot;
  )</code></pre>
<p><img src="Ohio_data_analyzing_files/figure-html/unnamed-chunk-7-1.png" width="100%" /> In the graph of Drug Overdose Deaths with Drug Categories by Year, we observe that year 2017 have highest number of drug overdose death than other years.</p>
<pre class="r"><code>oh_death_by_year %&gt;%
  ungroup() %&gt;% 
  ggplot(aes(x = month, y = percent_overdose_death, group = NA, color = year)) +
  geom_point() +
  geom_line() +
  facet_grid(.~ year) +
  labs(
    title = &quot;Percent of Drug Overdose Deaths over Total Number of Deaths by Year in OH&quot;,
    x = &quot;Months&quot;,
    y = &quot;Percent of Drug Overdose Deaths&quot;,
    caption = &quot;Data comes from VSRR_Provisional_Drug_Overdose_Death_Counts dataset from 2015 to 2021.&quot;
  ) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) </code></pre>
<p><img src="Ohio_data_analyzing_files/figure-html/unnamed-chunk-8-1.png" width="90%" /></p>
<p>In the graph of Each month Drug Overdose Death Within a Year, we are able to see the trend changing of drug overdose in continuous years. The highest percentage of drug overdose death is 2017. There is increase percentage of cause drug overdose death in 2020 which is cause by the COVID-19.</p>
<p><br><br></p>
</div>
<div id="drug-year" class="section level2">
<h2>Drug ~ Year</h2>
<p><img src="Ohio_data_analyzing_files/figure-html/unnamed-chunk-9-1.png" width="90%" /></p>
<p>In the graph of Number of Drug Overdose Deaths with Drug Categories by Year, we can see that drug overdose death in Ohio keep increasing over 2019-2021 with specific drug types like Heroin, Opioids and Synthetic Opioids. Since we miss data from 2015-2018, so we just include 2019-2021 in this graph.</p>
<p><br><br></p>
</div>
<div id="by-age-and-race" class="section level2">
<h2>By Age and Race</h2>
<pre class="r"><code>oh_death_by_age = 
  read_csv(&quot;./data/agegroup_race_state_year_99-19.csv&quot;) %&gt;%
  janitor::clean_names() %&gt;% 
  select(state, year, ten_year_age_groups, race, deaths, population) %&gt;% 
  filter(state %in% c(&quot;Ohio&quot;)) %&gt;% 
  mutate(year = factor(year),
         crude_rate = deaths/population * 100000)
  
oh_death_by_age %&gt;% 
  mutate(ten_year_age_groups = gsub(&quot;years&quot;, &quot;&quot;, ten_year_age_groups)) %&gt;% 
  ggplot(aes(x = ten_year_age_groups , y = crude_rate, fill = race)) + 
  geom_boxplot(alpha = 0.5)+
  facet_grid(~race)+
  labs(y = &quot;Drug Overdose Death Crude Rates&quot;, x = &quot;Age Groups&quot;) +
  ggtitle(&quot;Crude Death Rate in Ohio Across Race and Age Groups&quot;) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.4, hjust = 1))</code></pre>
<p><img src="Ohio_data_analyzing_files/figure-html/unnamed-chunk-10-1.png" width="90%" /></p>
<p>Overdose death with Drug Categories by Age and Race shows that black or African American people in Ohio among age 55-64 have highest drug overdose death rate. White people in Ohio among age 35-44 have highest drug overdose death rate.</p>
<p><br><br></p>
</div>
<div id="income" class="section level2">
<h2>Income</h2>
<p><strong>Number of death vs median household income</strong></p>
<pre class="r"><code>OH_income_df = 
  read_csv(&quot;./data/Median_Household_Income_OH.csv&quot;) %&gt;% 
  janitor::clean_names() %&gt;% 
  select(year, household_income_by_race, household_income_by_race_moe, geography) %&gt;% 
  filter(str_detect(geography,&quot;OH|Ohio|United States&quot;),
    year &gt;= &quot;2015&quot;) %&gt;% 
  mutate(year = factor(year))

OH_income_df %&gt;% 
  mutate(text_label = str_c(&quot;Year: &quot;, year, &quot;\nMedian Household Income: $&quot;, household_income_by_race, 
                            &quot;\nMargin of error: ± $&quot;, household_income_by_race_moe)) %&gt;% 
   plot_ly(
    x = ~year, y = ~household_income_by_race, color = ~geography, text = ~text_label, 
    alpha = 0.5, type = &quot;scatter&quot;, mode = &quot;markers+lines&quot;, colors = &quot;viridis&quot;, error_y = ~list(array = household_income_by_race_moe)) %&gt;% 
  layout(
    title = &quot;Median Household Income: OH vs. The U.S&quot;,
         xaxis = list(title = &quot;Year&quot;),
         yaxis = list(title = &quot;Median Household Income&quot;))</code></pre>
<div id="htmlwidget-03945653834abb6db6f4" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-03945653834abb6db6f4">{"x":{"visdat":{"ff5e3eb6185e":["function () ","plotlyVisDat"]},"cur_data":"ff5e3eb6185e","attrs":{"ff5e3eb6185e":{"x":{},"y":{},"text":{},"mode":"markers+lines","error_y":{},"color":{},"colors":"viridis","alpha":0.5,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Median Household Income: OH vs. The U.S","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Median Household Income"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2019","2018","2017","2016","2015"],"y":[66825,62743,61653,60260,56826],"text":["Year: 2019<br />Median Household Income: $66825<br />Margin of error: ± $1322","Year: 2018<br />Median Household Income: $62743<br />Margin of error: ± $1087","Year: 2017<br />Median Household Income: $61653<br />Margin of error: ± $967","Year: 2016<br />Median Household Income: $60260<br />Margin of error: ± $1049","Year: 2015<br />Median Household Income: $56826<br />Margin of error: ± $895"],"mode":"markers+lines","error_y":{"color":"rgba(68,1,84,0.5)","array":[118,563,1322,94,425]},"type":"scatter","name":"Cincinnati, OH-KY-IN","marker":{"color":"rgba(68,1,84,0.5)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,0.5)"},"error_x":{"color":"rgba(68,1,84,0.5)"},"line":{"color":"rgba(68,1,84,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[58642,56111,54021,52334,51075],"text":["Year: 2019<br />Median Household Income: $58642<br />Margin of error: ± $563","Year: 2018<br />Median Household Income: $56111<br />Margin of error: ± $425","Year: 2017<br />Median Household Income: $54021<br />Margin of error: ± $411","Year: 2016<br />Median Household Income: $52334<br />Margin of error: ± $275","Year: 2015<br />Median Household Income: $51075<br />Margin of error: ± $233"],"mode":"markers+lines","error_y":{"color":"rgba(33,144,141,0.5)","array":[1087,86,411,967,115]},"type":"scatter","name":"Ohio","marker":{"color":"rgba(33,144,141,0.5)","line":{"color":"rgba(33,144,141,1)"}},"textfont":{"color":"rgba(33,144,141,0.5)"},"error_x":{"color":"rgba(33,144,141,0.5)"},"line":{"color":"rgba(33,144,141,0.5)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2019","2018","2017","2016","2015"],"y":[65712,61937,60336,57617,55775],"text":["Year: 2019<br />Median Household Income: $65712<br />Margin of error: ± $118","Year: 2018<br />Median Household Income: $61937<br />Margin of error: ± $94","Year: 2017<br />Median Household Income: $60336<br />Margin of error: ± $86","Year: 2016<br />Median Household Income: $57617<br />Margin of error: ± $115","Year: 2015<br />Median Household Income: $55775<br />Margin of error: ± $85"],"mode":"markers+lines","error_y":{"color":"rgba(253,231,37,0.5)","array":[275,1049,85,233,895]},"type":"scatter","name":"United States","marker":{"color":"rgba(253,231,37,0.5)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,0.5)"},"error_x":{"color":"rgba(253,231,37,0.5)"},"line":{"color":"rgba(253,231,37,0.5)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Ohio around Cincinnati, Kentucky, Indiana have the higher income compare to other part of Ohio and US.</p>
<p><br></p>
<p><strong>Income and drug overdose death percent by year</strong></p>
<pre class="r"><code>OHincome_drug_df = 
  Ohio_death %&gt;% 
  ungroup() %&gt;% 
  group_by(year) %&gt;% 
  summarize(overdose_death_rate = sum(number_of_drug_overdose_deaths)/sum(number_of_deaths)) %&gt;% 
  inner_join(., OH_income_df %&gt;% filter(geography %in% &quot;Ohio&quot;))

year_death = 
  OHincome_drug_df %&gt;% 
  ggplot(aes(x = year, y = overdose_death_rate, group = NA))+
  geom_point()+
  geom_line()
income_year = 
  OHincome_drug_df %&gt;% 
  ggplot(aes(x = year, y = household_income_by_race, group = NA))+
  geom_point()+
  geom_line()

smooth = 
  OHincome_drug_df %&gt;% 
  ggplot(aes(x = household_income_by_race, y = overdose_death_rate, group = NA))+
  geom_point()+
  geom_smooth(method = &quot;lm&quot;, se = FALSE, color = &quot;royalblue4&quot;)
(year_death + income_year)/smooth</code></pre>
<p><img src="Ohio_data_analyzing_files/figure-html/unnamed-chunk-12-1.png" width="90%" /></p>
<p>From graph income VS drug overdose we can find that higher drug overdose rate have association with higher income.</p>
<p><br><br></p>
</div>
<div id="oh-drug-map" class="section level2">
<h2>OH Drug Map</h2>
<pre class="r"><code>data(county.fips)
abc = county.fips %&gt;% 
  separate(polyname, into = c(&quot;state&quot;, &quot;county&quot;), sep = &quot;\\,&quot;) %&gt;% 
  filter(state %in% &quot;ohio&quot;) %&gt;% 
  select(-state) %&gt;% 
  as_tibble()</code></pre>
<p>Our drug map shows that highest death rate occur in south Ohio region, which is close to the region have higher income in Ohio. This finding can imply the association between high income and high drug overdose death rate.</p>
<div id="counties-change-5-yr-interval" class="section level3 tabset">
<h3 class="tabset">Counties change, 5-yr interval</h3>
<div id="section" class="section level4">
<h4>2003</h4>
<pre class="r"><code>year_select = 2003
start_county_df = left_join(oh_county_df ,abc, by = &quot;county&quot;) %&gt;% 
  select(county, year, death_rate, fips) %&gt;% 
  filter(year == year_select)


start_county_df %&gt;% 
  group_by(fips) %&gt;% 
  mutate(fips = as.numeric(fips)) %&gt;% 
  rename(region = fips,
         value = death_rate) %&gt;% 
  county_choropleth(state_zoom = c(&quot;ohio&quot;),
                     legend = &quot;death_rate&quot;)+
  highlight_county(start_county_df[which.max(pull(start_county_df, death_rate)),])+
  add_text_county(start_county_df[which.max(pull(start_county_df, death_rate)),])</code></pre>
<p><img src="Ohio_data_analyzing_files/figure-html/unnamed-chunk-15-1.png" width="90%" /></p>
</div>
<div id="section-1" class="section level4">
<h4>2008</h4>
<pre class="r"><code>year_select = 2008
start_county_df = left_join(oh_county_df,abc, by = &quot;county&quot;) %&gt;% 
  select(county, year, death_rate, fips) %&gt;% 
  filter(year == year_select)

start_county_df %&gt;% 
  group_by(fips) %&gt;% 
  mutate(fips = as.numeric(fips)) %&gt;% 
  rename(region = fips,
         value = death_rate) %&gt;% 
  county_choropleth(state_zoom = c(&quot;ohio&quot;),
                     legend = &quot;death_rate&quot;)+
  highlight_county(start_county_df[which.max(pull(start_county_df, death_rate)),])+
  add_text_county(start_county_df[which.max(pull(start_county_df, death_rate)),])</code></pre>
<p><img src="Ohio_data_analyzing_files/figure-html/unnamed-chunk-16-1.png" width="90%" /></p>
</div>
<div id="section-2" class="section level4">
<h4>2013</h4>
<pre class="r"><code>year_select = 2013

start_county_df = left_join(oh_county_df,abc, by = &quot;county&quot;) %&gt;% 
  select(county, year, death_rate, fips) %&gt;% 
  filter(year == year_select)


start_county_df %&gt;% 
  group_by(fips) %&gt;% 
  mutate(fips = as.numeric(fips)) %&gt;% 
  rename(region = fips,
         value = death_rate) %&gt;% 
  county_choropleth(state_zoom = c(&quot;ohio&quot;),
                     legend = &quot;death_rate&quot;)+
  highlight_county(start_county_df[which.max(pull(start_county_df, death_rate)),])+
  add_text_county(start_county_df[which.max(pull(start_county_df, death_rate)),])</code></pre>
<p><img src="Ohio_data_analyzing_files/figure-html/unnamed-chunk-17-1.png" width="90%" /></p>
</div>
<div id="section-3" class="section level4">
<h4>2018</h4>
<p><img src="Ohio_data_analyzing_files/figure-html/unnamed-chunk-18-1.png" width="90%" /></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
